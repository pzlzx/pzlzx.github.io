

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/71F99186DE853565BD6D63B7E365DF93.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="XYCTF RE WP你真的是大学生吗 在一个运行于DOS环境下的汇编语言程序中，int 21h 的使用是非常频繁的，因为它提供了与操作系统进行交互的主要手段。每当程序需要进行输入输出操作、访问文件、控制屏幕显示、管理内存或是结束程序等操作时，通常都会调用 int 21h 来实现这些功能。  mov     ah, 9: 这里将9送入AH寄存器中，9是DOS中断调用功能号，对应于“输出$-term">
<meta property="og:type" content="article">
<meta property="og:title" content="XYCTF RE WP1">
<meta property="og:url" content="http://example.com/2024/05/08/XYCTF%20RE%20WP/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="XYCTF RE WP你真的是大学生吗 在一个运行于DOS环境下的汇编语言程序中，int 21h 的使用是非常频繁的，因为它提供了与操作系统进行交互的主要手段。每当程序需要进行输入输出操作、访问文件、控制屏幕显示、管理内存或是结束程序等操作时，通常都会调用 int 21h 来实现这些功能。  mov     ah, 9: 这里将9送入AH寄存器中，9是DOS中断调用功能号，对应于“输出$-term">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405052028645.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405052121029.png">
<meta property="og:image" content="c:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20240505230946614.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090020226.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090027334.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090030362.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090030292.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090037734.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090044391.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090044924.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090047725.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090047358.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090048868.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090049632.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090052451.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281309313.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404100026275.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404100045524.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404100047829.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404100044594.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281642974.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281643650.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281645045.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404100106991.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404121601693.png">
<meta property="og:image" content="c:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20240222220836421.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404121922862.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404122000994.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404111846794.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404111856164.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404111859039.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404111903220.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404112033709.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404112039757.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404112042924.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404112220437.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404112226664.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404112228965.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405070059757.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405070131550.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405070134247.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405070135874.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404112321198.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404202200097.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404202212111.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404202210722.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404232059673.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404232114151.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404232115029.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404232118153.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404232126626.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281409750.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281517732.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281412868.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281413883.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281416906.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405071505877.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405071530293.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405080134910.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405080136889.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405080142169.png">
<meta property="article:published_time" content="2024-05-07T18:09:42.423Z">
<meta property="article:modified_time" content="2024-05-07T18:08:56.215Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405052028645.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>XYCTF RE WP1 - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"\\img\\A008779F61D12BE23A64C76080892F5C.jpg","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  



  
<meta name="generator" content="Hexo 7.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>wwzx blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/EF13D2BBFB766BCFD972CC883B67E7AB.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="XYCTF RE WP1"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-05-08 02:09" pubdate>
          2024年5月8日 凌晨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          7k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          59 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">XYCTF RE WP1</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="XYCTF-RE-WP"><a href="#XYCTF-RE-WP" class="headerlink" title="XYCTF RE WP"></a>XYCTF RE WP</h1><h2 id="你真的是大学生吗"><a href="#你真的是大学生吗" class="headerlink" title="你真的是大学生吗"></a>你真的是大学生吗</h2><p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405052028645.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240505202846580"></p>
<p>在一个运行于DOS环境下的汇编语言程序中，<code>int 21h</code> 的使用是非常频繁的，因为它提供了与操作系统进行交互的主要手段。每当程序需要进行输入输出操作、访问文件、控制屏幕显示、管理内存或是结束程序等操作时，通常都会调用 <code>int 21h</code> 来实现这些功能。</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405052121029.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240505212101984"></p>
<p><code>mov     ah, 9</code>: 这里将9送入AH寄存器中，9是DOS中断调用功能号，对应于“输出$-terminated字符串到标准输出（通常是显示器）”的功能。</p>
<p><code>int     21h</code>: 最后，通过执行INT 21h指令，程序触发DOS中断，调用之前设置好的功能号9的服务。DOS会读取DX寄存器中的地址作为字符串的起始位置，然后将该地址指向的字符串输出到屏幕上。</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-built_in">SI</span>默认就使用<span class="hljs-built_in">DS</span><br></code></pre></td></tr></table></figure>

<p><img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20240505230946614.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240505230946614"></p>
<p>其实除了静态分析也可以直接box走起</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><br>#include &lt;stdio<span class="hljs-number">.</span>h&gt;<br> <br><span class="hljs-keyword">int</span> main()<br>&#123;<br>    unsigned char data[<span class="hljs-number">20</span>] = &#123;<br>    <span class="hljs-number">0x76</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x03</span>, <br>    <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x05</span>,<br>&#125;<span class="hljs-comment">;</span><br>    for(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span><span class="hljs-comment">; i &lt; 19;i++) &#123;</span><br>            printf(<span class="hljs-string">&quot;%c&quot;</span>,data[i] ^ data[i+<span class="hljs-number">1</span>])<span class="hljs-comment">;</span><br>    &#125;<br>   return <span class="hljs-number">0</span><span class="hljs-comment">;</span><br>&#125;<br></code></pre></td></tr></table></figure>



<h2 id="baby-unity"><a href="#baby-unity" class="headerlink" title="baby unity"></a>baby unity</h2><p><a target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-278275.htm">https://bbs.kanxue.com/thread-278275.htm</a></p>
<p>题目附件下载以后发现是il2cpp的脚本处理方式（和平时一般做的mono的不一样）</p>
<p>将几个文件脱upx壳后</p>
<p>用010 editor检查”\baby unity_Data\il2cpp_data\Metadata\global-metadata.dat”文件，发现文件头为AF 1B B1 FA无异常</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090020226.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240409002009134"></p>
<p>通过<a target="_blank" rel="noopener" href="https://github.com/Perfare/Il2CppDumper/%E4%B8%8B%E8%BD%BD%E5%B7%A5%E5%85%B7">https://github.com/Perfare/Il2CppDumper/下载工具</a></p>
<p>说明里面提到的命令行格式为：</p>
<p>Il2CppDumper.exe executable-file  global-metadata  output-directory</p>
<p>用了这个没整起也不知道原因是什么</p>
<p>直接使用下载好的工具里面的Il2CppDumper.exe打开，在下载的题目的路径里面依次选中GameAssembly.dll以及”\baby unity_Data\il2cpp_data\Metadata\global-metadata.dat”（其实本来按照教程应该是libil2cpp.so文件，即 apk的dll，但这个不是apk是exe)然后这个地方的GameAssembly相当于so文件</p>
<p>运行成功</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090027334.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240409002730299"></p>
<p>然后就在il2cppdumper的下载目录下面出现Dummydll以及下图</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090030362.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240409003016337"></p>
<p>这个是Dummy.dll下面的</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090030292.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240409003058259"></p>
<p>使用dnspy 32打开Assembly-Csharp</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090037734.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240409003753670"></p>
<p>然后可以看到加密函数名称</p>
<p>用IDA64打开GameAssembly.dll</p>
<p>使用script file 导入文件，依次选择ida py3和script.json</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090044391.jpg" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="BABDBA394F32490D7F3FA2098EFAF0C0"></p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090044924.jpg" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="2E4263D45BDE39932974847882E9A494"></p>
<p>根据最开始上面贴的教程没有选择导入</p>
<p>然后分析界面的函数名称就清晰很多了，直接在函数窗口搜索对应的两个函数，checkflag和encrypt</p>
<p>分析逻辑如下</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090047725.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240409004715644"></p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090047358.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240409004751261"></p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090048868.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240409004830829"></p>
<p>最后一步即为比较加密后的flag和已知字符串，双击获得该字符串</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090049632.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240409004946567"></p>
<p>脚本：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs stylus">import base64<br><br><span class="hljs-comment">//已知经过处理后的字符串</span><br><br>v7_str = <span class="hljs-string">&quot;XIcKYJU8Buh:UeV:BKN&#123;U[JvUL??VuZ?CXJ;AX^&#123;Ae]gA[]gUecb@K]ei^22&quot;</span><br><br><span class="hljs-comment">//将字符串转换为字节</span><br><br>reversed_v7_bytes = <span class="hljs-built_in">bytes</span>(v7_str, <span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><span class="hljs-comment">//Step 2: 对字节进行异或操作还原</span><br><br><span class="hljs-comment">//因为Python字节是单字节的，所以我们不需要按对进行操作</span><br><br>reversed_v7_recovered = <span class="hljs-built_in">bytearray</span>()<br><span class="hljs-keyword">for</span> <span class="hljs-selector-tag">i</span>, byte <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(reversed_v7_bytes):<br>    reversed_v7_recovered<span class="hljs-selector-class">.append</span>(byte ^ <span class="hljs-number">0</span>xF)<br><br><span class="hljs-comment">//Step 4: Base64解码（假设v7_str已经是Base64编码过的）</span><br><br><span class="hljs-comment">//注意：由于不清楚原始的Base64编码是否有padding，这里假设没有padding</span><br><br>try:<br>    v5_decoded = base64<span class="hljs-selector-class">.b64decode</span>(reversed_v7_recovered)<br>except Exception as e:<br>    <span class="hljs-built_in">print</span>(f<span class="hljs-string">&quot;Base64解码时发生错误: &#123;e&#125;&quot;</span>)<br>    v5_decoded = None<br><br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-string">&quot;尝试还原的原始字节数组v5:&quot;</span>, v5_decoded)</span></span><br></code></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404090052451.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240409005252384"></p>
<p>XYCTF{389f6900-e12d-4c54-a85d-64a54af9f84c}</p>
<h2 id="DebugMe"><a href="#DebugMe" class="headerlink" title="DebugMe"></a>DebugMe</h2><p>题目提示需要debugger,于是查看该apk附件的xml</p>
<p>发现没有debugger,所以在模拟器上使用mt管理器添加调试权限</p>
<p>步骤可参考<a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1714727-1-1.html">《安卓逆向这档事》五、1000-7&#x3D;？&amp;动态调试&amp;Log插桩 - 『移动安全区』 - 吾爱破解 - LCG - LSG |安卓破解|病毒分析|www.52pojie.cn</a></p>
<p>（随便找个地方加到application里面就行了，加中间省事）</p>
<p>形如这样</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281309313.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240428130924255"></p>
<p>然后再保存以后再安装，然后可以尝试将修改后的apk导出，用jadx查看xml发现添加成功（有点多此一举，可以直接mt看）</p>
<p>android:debuggable&#x3D;”true”</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404100026275.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240410002645206"></p>
<p>(上面这个不行，记下来告诫自己)</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404100045524.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240410004511497"></p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404100047829.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240410004725755"></p>
<p>设置断点然后开始运行，附上进程即可获得flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404100044594.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240410004452515"></p>
<p>针对这个题，接着去看了下安卓的东西</p>
<p>linux或者安卓下的proc保留的是当前进程下面的进程号，文件句柄之类的</p>
<p>这里提一下proc下面的self，cmdline,environ(当前程序的环境变量，如果flag放在环境变量里面，可以读取这个去找flag)，然后非预期也是和这个地方有关</p>
<p>DEX可执行文件，因为后续使用kotlin编写的最后与java是兼容的，所以后续的dex也可以使用jadx进行反编译</p>
<p>jeb可进行动态跟踪</p>
<p>这里复习一下apktool解包命令apktool d</p>
<p>重新打包apktool b</p>
<p>出题人说混淆器用的BlackObfuscator，depth设的高了点，好像有些版本的jadx直接报错了</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281642974.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240428164253906"></p>
<p>混淆可以通过jeb去掉，可以去smali改debug的if判定出flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281643650.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240428164352546"></p>
<p>调试层面也可以通过jadx，在adb路径处直接填写待调试exe的路径即可</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281645045.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240428164515002"></p>
<h2 id="ez-cube"><a href="#ez-cube" class="headerlink" title="ez_cube"></a>ez_cube</h2><p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404100106991.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240410010641924"></p>
<p>建议改下变量名字</p>
<p>可以直接通过该魔方模型进行推算步骤，也可以进行爆破</p>
<p>题目：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">__int64 <span class="hljs-title">sub_7FF629032930</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+44h] [rbp+24h]</span><br><span class="hljs-type">char</span> input_steps; <span class="hljs-comment">// [rsp+64h] [rbp+44h]</span><br><span class="hljs-type">int</span> v3; <span class="hljs-comment">// [rsp+84h] [rbp+64h]</span><br><span class="hljs-built_in">sub_7FF629031384</span>((__int64)&amp;unk_7FF6290440A2);<br><span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">9</span>; ++i ) <span class="hljs-comment">// 初始化cube</span><br>&#123;<br>surface1[i] = &amp;Red;<br>surface2[i] = <span class="hljs-string">&quot;Blue&quot;</span>;<br>surface3[i] = <span class="hljs-string">&quot;Green&quot;</span>;<br>surface4[i] = <span class="hljs-string">&quot;Orange&quot;</span>;<br>surface5[i] = <span class="hljs-string">&quot;Yellow&quot;</span>;<br>surface6[i] = <span class="hljs-string">&quot;White&quot;</span>;<br>&#125;<br>surface2[<span class="hljs-number">1</span>] = &amp;Red;<br>surface1[<span class="hljs-number">1</span>] = <span class="hljs-string">&quot;Green&quot;</span>;<br>surface3[<span class="hljs-number">1</span>] = <span class="hljs-string">&quot;Blue&quot;</span>;<br><span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>&#123;<br><span class="hljs-keyword">do</span><br>input_steps = <span class="hljs-built_in">getchar</span>();<br><span class="hljs-keyword">while</span> ( input_steps == <span class="hljs-number">10</span> ); <span class="hljs-comment">// 读取回车就下一步</span><br><span class="hljs-keyword">switch</span> ( input_steps )<br>&#123;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;R&#x27;</span>:<br><span class="hljs-built_in">sub_7FF629031375</span>();<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;U&#x27;</span>:<br><span class="hljs-built_in">sub_7FF6290313BB</span>();<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;r&#x27;</span>:<br><span class="hljs-built_in">sub_7FF629031366</span>();<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;u&#x27;</span>:<br><span class="hljs-built_in">sub_7FF62903115E</span>();<br><span class="hljs-keyword">break</span>;<br>&#125;<br>++steps;<br>v3 = <span class="hljs-built_in">cmp</span>();<br><span class="hljs-keyword">if</span> ( v3 == <span class="hljs-number">1</span> )<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">if</span> ( v3 == <span class="hljs-number">2</span> )<br><span class="hljs-keyword">goto</span> LABEL_19;<br>&#125;<br><span class="hljs-built_in">printf</span>(aGreatYouAreAGo);<br>LABEL_19:<br><span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;pause&quot;</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>i64;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><code class="hljs prolog">from itertools import *<br>red = [<span class="hljs-string">&#x27;&#x27;</span>] * <span class="hljs-number">9</span><br>blue = [<span class="hljs-string">&#x27;&#x27;</span>] * <span class="hljs-number">9</span><br>green = [<span class="hljs-string">&#x27;&#x27;</span>] * <span class="hljs-number">9</span><br>orange = [<span class="hljs-string">&#x27;&#x27;</span>] * <span class="hljs-number">9</span><br>yellow = [<span class="hljs-string">&#x27;&#x27;</span>] * <span class="hljs-number">9</span><br>white = [<span class="hljs-string">&#x27;&#x27;</span>] * <span class="hljs-number">9</span><br>def init_cube():<br>	for i in range(<span class="hljs-number">9</span>):<br>		red[i] = <span class="hljs-string">&quot;red&quot;</span><br>		blue[i] = <span class="hljs-string">&quot;Blue&quot;</span><br>		green[i] = <span class="hljs-string">&quot;Green&quot;</span><br>		orange[i] = <span class="hljs-string">&quot;Orange&quot;</span><br>		yellow[i] = <span class="hljs-string">&quot;Yellow&quot;</span><br>		white[i] = <span class="hljs-string">&quot;White&quot;</span><br>		blue[<span class="hljs-number">1</span>] = <span class="hljs-string">&quot;red&quot;</span><br>		red[<span class="hljs-number">1</span>] = <span class="hljs-string">&quot;Green&quot;</span><br>		green[<span class="hljs-number">1</span>] = <span class="hljs-string">&quot;Blue&quot;</span><br>def <span class="hljs-symbol">MOVE_R</span>():<br>	v1 = red[<span class="hljs-number">2</span>]<br>	v2 = red[<span class="hljs-number">5</span>]<br>	v3 = red[<span class="hljs-number">8</span>]<br>	red[<span class="hljs-number">2</span>] = white[<span class="hljs-number">2</span>]<br>	red[<span class="hljs-number">5</span>] = white[<span class="hljs-number">5</span>]<br>	red[<span class="hljs-number">8</span>] = white[<span class="hljs-number">8</span>]<br>	white[<span class="hljs-number">2</span>] = orange[<span class="hljs-number">6</span>]<br>	white[<span class="hljs-number">5</span>] = orange[<span class="hljs-number">3</span>]<br>	white[<span class="hljs-number">8</span>] = orange[<span class="hljs-number">0</span>]<br>	orange[<span class="hljs-number">0</span>] = yellow[<span class="hljs-number">8</span>]<br>	orange[<span class="hljs-number">3</span>] = yellow[<span class="hljs-number">5</span>]<br>	orange[<span class="hljs-number">6</span>] = yellow[<span class="hljs-number">2</span>]<br>	yellow[<span class="hljs-number">2</span>] = v1<br>	yellow[<span class="hljs-number">5</span>] = v2<br>	yellow[<span class="hljs-number">8</span>] = v3<br>	v4 = green[<span class="hljs-number">1</span>]<br>	green[<span class="hljs-number">1</span>] = green[<span class="hljs-number">3</span>]<br>	green[<span class="hljs-number">3</span>] = green[<span class="hljs-number">7</span>]<br>	green[<span class="hljs-number">7</span>] = green[<span class="hljs-number">5</span>]<br>	green[<span class="hljs-number">5</span>] = v4<br>	v5 = green[<span class="hljs-number">0</span>]<br>	green[<span class="hljs-number">0</span>] = green[<span class="hljs-number">6</span>]<br>	green[<span class="hljs-number">6</span>] = green[<span class="hljs-number">8</span>]<br>	green[<span class="hljs-number">8</span>] = green[<span class="hljs-number">2</span>]<br>	green[<span class="hljs-number">2</span>] = v5<br>def <span class="hljs-symbol">MOVE_U</span>():<br>	v1 = red[<span class="hljs-number">0</span>]<br>	v2 = red[<span class="hljs-number">1</span>]<br>	v3 = red[<span class="hljs-number">2</span>]<br>	red[<span class="hljs-number">0</span>] = green[<span class="hljs-number">0</span>]<br>	red[<span class="hljs-number">1</span>] = green[<span class="hljs-number">1</span>]<br>	red[<span class="hljs-number">2</span>] = green[<span class="hljs-number">2</span>]<br>	green[<span class="hljs-number">0</span>] = orange[<span class="hljs-number">0</span>]<br>	green[<span class="hljs-number">1</span>] = orange[<span class="hljs-number">1</span>]<br>	green[<span class="hljs-number">2</span>] = orange[<span class="hljs-number">2</span>]<br>	orange[<span class="hljs-number">0</span>] = blue[<span class="hljs-number">0</span>]<br>	orange[<span class="hljs-number">1</span>] = blue[<span class="hljs-number">1</span>]<br>	orange[<span class="hljs-number">2</span>] = blue[<span class="hljs-number">2</span>]<br>	blue[<span class="hljs-number">0</span>] = v1<br>	blue[<span class="hljs-number">1</span>] = v2<br>	blue[<span class="hljs-number">2</span>] = v3<br>	v4 = yellow[<span class="hljs-number">1</span>]<br>	yellow[<span class="hljs-number">1</span>] = yellow[<span class="hljs-number">3</span>]<br>	yellow[<span class="hljs-number">3</span>] = yellow[<span class="hljs-number">7</span>]<br>	yellow[<span class="hljs-number">7</span>] = yellow[<span class="hljs-number">5</span>]<br>	yellow[<span class="hljs-number">5</span>] = v4<br>	v5 = yellow[<span class="hljs-number">0</span>]<br>	yellow[<span class="hljs-number">0</span>] = yellow[<span class="hljs-number">6</span>]<br>	yellow[<span class="hljs-number">6</span>] = yellow[<span class="hljs-number">8</span>]<br>	yellow[<span class="hljs-number">8</span>] = yellow[<span class="hljs-number">2</span>]<br>	yellow[<span class="hljs-number">2</span>] = v5<br><br>def <span class="hljs-symbol">MOVE_r</span>():<br>	v1 = red[<span class="hljs-number">2</span>]<br>	v2 = red[<span class="hljs-number">5</span>]<br>	v3 = red[<span class="hljs-number">8</span>]<br>	red[<span class="hljs-number">2</span>] = yellow[<span class="hljs-number">2</span>]<br>	red[<span class="hljs-number">5</span>] = yellow[<span class="hljs-number">5</span>]<br>	red[<span class="hljs-number">8</span>] = yellow[<span class="hljs-number">8</span>]<br>	yellow[<span class="hljs-number">2</span>] = orange[<span class="hljs-number">6</span>]<br>	yellow[<span class="hljs-number">5</span>] = orange[<span class="hljs-number">3</span>]<br>	yellow[<span class="hljs-number">8</span>] = orange[<span class="hljs-number">0</span>]<br>	orange[<span class="hljs-number">0</span>] = white[<span class="hljs-number">8</span>]<br>	orange[<span class="hljs-number">3</span>] = white[<span class="hljs-number">5</span>]<br>	orange[<span class="hljs-number">6</span>] = white[<span class="hljs-number">2</span>]<br>	white[<span class="hljs-number">2</span>] = v1<br>	white[<span class="hljs-number">5</span>] = v2<br>	white[<span class="hljs-number">8</span>] = v3<br>	v4 = green[<span class="hljs-number">1</span>]<br>	green[<span class="hljs-number">1</span>] = green[<span class="hljs-number">5</span>]<br>	green[<span class="hljs-number">5</span>] = green[<span class="hljs-number">7</span>]<br>	green[<span class="hljs-number">7</span>] = green[<span class="hljs-number">3</span>]<br>	green[<span class="hljs-number">3</span>] = v4<br>	v5 = green[<span class="hljs-number">0</span>]<br>	green[<span class="hljs-number">0</span>] = green[<span class="hljs-number">2</span>]<br>	green[<span class="hljs-number">2</span>] = green[<span class="hljs-number">8</span>]<br>	green[<span class="hljs-number">8</span>] = green[<span class="hljs-number">6</span>]<br>	green[<span class="hljs-number">6</span>] = v5<br>def <span class="hljs-symbol">MOVE_u</span>():<br>	v1 = red[<span class="hljs-number">0</span>]<br>	v2 = red[<span class="hljs-number">1</span>]<br>	v3 = red[<span class="hljs-number">2</span>]<br>	red[<span class="hljs-number">0</span>] = blue[<span class="hljs-number">0</span>]<br>	red[<span class="hljs-number">1</span>] = blue[<span class="hljs-number">1</span>]<br>	red[<span class="hljs-number">2</span>] = blue[<span class="hljs-number">2</span>]<br>	blue[<span class="hljs-number">0</span>] = orange[<span class="hljs-number">0</span>]<br>	blue[<span class="hljs-number">1</span>] = orange[<span class="hljs-number">1</span>]<br>	blue[<span class="hljs-number">2</span>] = orange[<span class="hljs-number">2</span>]<br>	orange[<span class="hljs-number">0</span>] = green[<span class="hljs-number">0</span>]<br>	orange[<span class="hljs-number">1</span>] = green[<span class="hljs-number">1</span>]<br>	orange[<span class="hljs-number">2</span>] = green[<span class="hljs-number">2</span>]<br>	green[<span class="hljs-number">0</span>] = v1<br>	green[<span class="hljs-number">1</span>] = v2<br>	green[<span class="hljs-number">2</span>] = v3<br>	v4 = yellow[<span class="hljs-number">1</span>]<br>	yellow[<span class="hljs-number">1</span>] = yellow[<span class="hljs-number">5</span>]<br>	yellow[<span class="hljs-number">5</span>] = yellow[<span class="hljs-number">7</span>]<br>	yellow[<span class="hljs-number">7</span>] = yellow[<span class="hljs-number">3</span>]<br>	yellow[<span class="hljs-number">3</span>] = v4<br>	v5 = yellow[<span class="hljs-number">0</span>]<br>	yellow[<span class="hljs-number">0</span>] = yellow[<span class="hljs-number">2</span>]<br>	yellow[<span class="hljs-number">2</span>] = yellow[<span class="hljs-number">8</span>]<br>	yellow[<span class="hljs-number">8</span>] = yellow[<span class="hljs-number">6</span>]<br>	yellow[<span class="hljs-number">6</span>] = v5<br>def <span class="hljs-symbol">Is_right</span>():<br>	<span class="hljs-symbol">Count</span> = <span class="hljs-number">0</span><br>	for i in range(<span class="hljs-number">9</span>):<br>		if red[i]  <span class="hljs-string">&quot;red&quot;</span>:<br>			<span class="hljs-symbol">Count</span> += <span class="hljs-number">1</span><br>		if blue[i]  <span class="hljs-string">&quot;Blue&quot;</span>:<br>			<span class="hljs-symbol">Count</span> += <span class="hljs-number">1</span><br>		if green[i]  <span class="hljs-string">&quot;Green&quot;</span>:<br>			<span class="hljs-symbol">Count</span> += <span class="hljs-number">1</span><br>		if orange[i]  <span class="hljs-string">&quot;Orange&quot;</span>:<br>			<span class="hljs-symbol">Count</span> += <span class="hljs-number">1</span><br>		if yellow[i]  <span class="hljs-string">&quot;Yellow&quot;</span>:<br>			<span class="hljs-symbol">Count</span> += <span class="hljs-number">1</span><br>		if white[i]  <span class="hljs-string">&quot;White&quot;</span>:<br>			<span class="hljs-symbol">Count</span> += <span class="hljs-number">1</span><br>#print(<span class="hljs-symbol">Count</span>)<br>	if <span class="hljs-symbol">Count</span> ! <span class="hljs-number">54</span>:<br>		return <span class="hljs-symbol">False</span><br>	return <span class="hljs-symbol">True</span><br>def main(flag):<br>	#print(flag)<br>	init_cube()<br>	for i in flag:<br>		if i  <span class="hljs-string">&quot;R&quot;</span>:<br>			<span class="hljs-symbol">MOVE_R</span>()<br>		if i  <span class="hljs-string">&quot;U&quot;</span>:<br>			<span class="hljs-symbol">MOVE_U</span>()<br>		if i  <span class="hljs-string">&#x27;r&#x27;</span>:<br>			<span class="hljs-symbol">MOVE_r</span>()<br>		if i  <span class="hljs-string">&#x27;u&#x27;</span>:<br>			<span class="hljs-symbol">MOVE_u</span>()<br>		if <span class="hljs-symbol">Is_right</span>():<br>			return flag<br>def get_flag():<br>	table = <span class="hljs-string">&quot;RrUu&quot;</span><br>	for string in product(table, repeat=<span class="hljs-number">12</span>):<br>	flag = <span class="hljs-string">&quot;&quot;</span>.join(string)<br>	ret = main(flag)<br>	if ret ! <span class="hljs-symbol">None</span>:<br>	print(ret)<br>	return<br>get_flag()<br></code></pre></td></tr></table></figure>



<h2 id="ez-rand"><a href="#ez-rand" class="headerlink" title="ez_rand"></a>ez_rand</h2><p>之前在某处学了个方法，</p>
<p>该文件使用IDA打开后分析逻辑不知道scanf到哪里去了，使用F5重新分析后获得输入逻辑</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404121601693.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240412160100536"></p>
<p><img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20240222220836421.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240222220836421"></p>
<p>v9 v10地址连续</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404121922862.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240412192224780"></p>
<p>即可以获取最后进行对比的数据v9——29位的flag，包含v10</p>
<p>v4是种子，srand函数和rand函数根据种子来生成随机数，input加密逻辑使用v7 那么首先想到的是爆破种子，来推flag 再看v4，unsigned __int16 v4无符号16位整数型，v4范围为0~2**16-1(65535)，结合flag固定格式 XYCTF{}</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs cpp">\<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br> \<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br> \<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br> \<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">containsXYCTF</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *str)</span></span><br><span class="hljs-function"> </span>&#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(str, <span class="hljs-string">&quot;XYCTF&quot;</span>) != <span class="hljs-literal">NULL</span>)<br>  &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>; <span class="hljs-comment">// 包含&quot;XYCTF&quot;</span><br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// 不包含&quot;XYCTF&quot;</span><br>  &#125;<br> &#125;<br> <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"> </span>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> cipher[<span class="hljs-number">29</span>] = &#123;<span class="hljs-number">0x5D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x34</span>, <br><span class="hljs-number">0xB2</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x91</span>, <br><span class="hljs-number">0x12</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4D</span>&#125;;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v7;<br>  <span class="hljs-type">char</span> flag[<span class="hljs-number">29</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> seed = <span class="hljs-number">0</span>; seed &lt; <span class="hljs-number">65536</span>; seed++)<br>  &#123;<br>    <span class="hljs-built_in">srand</span>(seed);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">29</span>; i++)<br>    &#123;<br>      v7 = <span class="hljs-built_in">rand</span>();<br>      <span class="hljs-type">int</span> num = (<span class="hljs-type">int</span>)((<span class="hljs-type">unsigned</span> __int64)(<span class="hljs-number">2155905153</span> * v7) &gt;&gt; <span class="hljs-number">32</span>);<br>      <span class="hljs-type">unsigned</span> __int8 data = (<span class="hljs-type">unsigned</span> __int8)(v7 + ((num &amp; <span class="hljs-number">0x80000000</span>) != <br><br><span class="hljs-number">0</span>) + (num &gt;&gt; <span class="hljs-number">7</span>));<br><br>​      flag[i] = cipher[i] ^ data;<br>​    &#125;<br>​    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">containsXYCTF</span>(flag))<br>&#123;<br> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;success\n&quot;</span>);<br> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;seed = %d\n&quot;</span>, seed);<br> <span class="hljs-built_in">puts</span>(flag);<br>			 &#125;<br>		 &#125;<br><br>	 &#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404122000994.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240412200052899"></p>
<h2 id="给阿姨倒一杯卡布奇诺"><a href="#给阿姨倒一杯卡布奇诺" class="headerlink" title="给阿姨倒一杯卡布奇诺"></a>给阿姨倒一杯卡布奇诺</h2><p>茶加密</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs prolog">#include &lt;stdio.h&gt;<br>#define uint32_t unsigned int<br><br>void decrypt(uint32_t *v, uint32_t *key)<br>&#123;<br>    static uint32_t data1 = <span class="hljs-number">0x5F797274</span>;<br>    static uint32_t data2 = <span class="hljs-number">0x64726168</span>;<br>    int i;   // [rsp+<span class="hljs-number">20</span>h] [rbp<span class="hljs-number">-10</span>h]<br>    uint32_t sum; // [rsp+<span class="hljs-number">24</span>h] [rbp-<span class="hljs-symbol">Ch</span>]<br>    uint32_t v1;  // [rsp+<span class="hljs-number">28</span>h] [rbp<span class="hljs-number">-8</span>h]<br>    uint32_t v0;  // [rsp+<span class="hljs-number">2</span><span class="hljs-symbol">Ch</span>] [rbp<span class="hljs-number">-4</span>h]<br><br>    sum = <span class="hljs-number">0x6E75316C</span> * <span class="hljs-number">32</span>;<br>    uint32_t data1_tmp = v[<span class="hljs-number">0</span>];<br>    uint32_t data2_tmp = v[<span class="hljs-number">1</span>];<br>    v0 = v[<span class="hljs-number">0</span>];<br>    v1 = v[<span class="hljs-number">1</span>];<br>    for (i = <span class="hljs-number">31</span>; i &gt;= <span class="hljs-number">0</span>; i--)<br>    &#123;<br>        v1 -= ((v0 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">3</span>]) ^ (v0 + sum) ^ (key[<span class="hljs-number">2</span>] + <span class="hljs-number">16</span> * v0) ^ (sum + i);<br>        v0 -= ((v1 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">1</span>]) ^ (v1 + sum) ^ (key[<span class="hljs-number">0</span>] + <span class="hljs-number">16</span> * v1) ^ (sum + i);<br>        sum -= <span class="hljs-number">0x6E75316C</span>;<br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0 ^ data1;<br>    v[<span class="hljs-number">1</span>] = v1 ^ data2;<br>    data1 = data1_tmp;<br>    data2 = data2_tmp;<br>&#125;<br><br>int main()<br>&#123;<br>    uint32_t key[<span class="hljs-number">4</span>];   // [rsp+<span class="hljs-number">60</span>h] [rbp<span class="hljs-number">-40</span>h] <span class="hljs-symbol">BYREF</span><br>    uint32_t array[<span class="hljs-number">8</span>]; // [rsp+<span class="hljs-number">70</span>h] [rbp<span class="hljs-number">-30</span>h]<br>    array[<span class="hljs-number">0</span>] = <span class="hljs-number">0x9B28ED45</span>;<br>    array[<span class="hljs-number">1</span>] = <span class="hljs-number">0x145EC6E9</span>;<br>    array[<span class="hljs-number">2</span>] = <span class="hljs-number">0x5B27A6C3</span>;<br>    array[<span class="hljs-number">3</span>] = <span class="hljs-number">0xE59E75D5</span>;<br>    array[<span class="hljs-number">4</span>] = <span class="hljs-number">0xE82C2500</span>;<br>    array[<span class="hljs-number">5</span>] = <span class="hljs-number">0xA4211D92</span>;<br>    array[<span class="hljs-number">6</span>] = <span class="hljs-number">0xCD8A4B62</span>;<br>    array[<span class="hljs-number">7</span>] = <span class="hljs-number">0xA668F440</span>;<br>    key[<span class="hljs-number">0</span>] = <span class="hljs-number">0x65766967</span>;<br>    key[<span class="hljs-number">1</span>] = <span class="hljs-number">0x756F795F</span>;<br>    key[<span class="hljs-number">2</span>] = <span class="hljs-number">0x7075635F</span>;<br>    key[<span class="hljs-number">3</span>] = <span class="hljs-number">0x6165745F</span>;<br>    for (int i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">7</span>; i += <span class="hljs-number">2</span>)<br>    &#123;<br>        decrypt(array + i, key);<br>    &#125;<br>    for(int i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">32</span>; i++)<br>    &#123;<br>        printf(<span class="hljs-string">&quot;%c&quot;</span>, ((char*)array)[i]);<br>    &#125;<br>    return <span class="hljs-number">0</span>;<br>&#125;<br><br>// <span class="hljs-number">133</span>bffe401d223a02385d90c5f1ca377<br></code></pre></td></tr></table></figure>









<h2 id="trustme"><a href="#trustme" class="headerlink" title="trustme"></a>trustme</h2><p>先看main activity发现下图，</p>
<p>代码：</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">public void <span class="hljs-built_in">onClick</span>(View view) &#123; ((TextView) <span class="hljs-built_in">findViewById</span>(C0875R.C0878id.username))<span class="hljs-selector-class">.getText</span>()<span class="hljs-selector-class">.toString</span>(); if (bytesToHex(RC4(((TextView) <span class="hljs-built_in">findViewById</span>(C0875R.C0878id.password))<span class="hljs-selector-class">.getText</span>()<span class="hljs-selector-class">.toString</span>()<span class="hljs-selector-class">.getBytes</span>(), &quot;XYCTF&quot;<span class="hljs-selector-class">.getBytes</span>()))<span class="hljs-selector-class">.equals</span>(&quot;<span class="hljs-number">5</span>a3c46e0228b444decc7651c8a7ca93ba4cb35a46f7eb589bef4&quot;)) &#123; Toast<span class="hljs-selector-class">.makeText</span>(this, &quot;成功!&quot;, <span class="hljs-number">0</span>); &#125; &#125;<br></code></pre></td></tr></table></figure>

<p>经过分析代码逻辑即为使用Android平台的一个onClick点击事件处理函数，当关联到该函数的视图（如按钮）被点击时，此函数会被触发执行，通过findViewById()方法找到与资源ID（C0875R.C0878id.），查找并获取界面上的TextView组件，然后调用getText()方法获取该TextView中的文本内容（username和password)，并进一步调用toString()方法将其转换为字符串形式。</p>
<p>发现下面的RC4为标准加密，</p>
<p>XYCTF”为密钥</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404111846794.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240411184602671"></p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404111856164.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240411185626064"></p>
<p>解密获得用户名为admin</p>
<p>然后发现没有找到password</p>
<p>学习一下</p>
<p>“ProxyApplication”通常是指开发者为了在应用程序启动之初就进行一些全局初始化操作或者代理系统默认的Application类来实现特定功能而自定义的一个Application子类。这样的类会在整个应用程序生命周期内始终存在，且在任何Activity或其他组件启动前就已经初始化完成。“</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404111859039.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240411185958907"></p>
<p>注意这里面的前两句，是java反射调用</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404111903220.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240411190330172"></p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404112033709.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240411203312598"></p>
<p>通过这个地方其实可以大差不差猜出来是把shell.apk放到了payload_dex”路径下面</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404112039757.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240411203949682"></p>
<p>在对应路径可以找到该apk文件</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404112042924.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240411204208855"></p>
<p>反编译该apk文件</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404112220437.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240411222000368"></p>
<p>发现执行了SQL查询，即判断应在数据库中存在password数据，当程序运行时输入password和username正确时会得到正确的flag</p>
<p>查看MoveSQLiteUtil类，发现创建了一个<code>File</code>对象<code>file</code>，指向预期的数据库文件路径，即上述目录下名为”mydb.db”的SQLite数据库文件（在安卓系统中，<code>db</code> 通常是 <code>Database</code>（数据库）的缩写，具体指的是 SQLite 数据库文件）</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404112226664.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240411222629591"></p>
<p>最后使用mt管理器找到该文件，找到flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404112228965.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240411222850926"></p>
<p>.db文件为SQLite数据库文件的标准格式之一</p>
<p>附——</p>
<p>看官方wp发现：其实通过直接看XML可以发现给的入口点和真正的入口点是不一样的，可以因此去判断有壳的存在</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405070059757.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240507005946638"></p>
<ul>
<li><code>android:name=&quot;com.swdd.trustme.ProxyApplication&quot;</code> 定义在<code>&lt;application&gt;</code>标签内，表明<code>ProxyApplication</code>是应用程序的主Application类。Application类是应用程序的入口点之一，负责初始化应用程序级别的组件、设置全局配置等。这是应用程序启动时第一个加载的类，可以视为一个高层的、全局的入口点。</li>
<li><code>android:name=&quot;com.swdd.tru5tme.MainActivity&quot;</code> 定义在<code>&lt;activity&gt;</code>标签内，并且设置了<code>android:exported=&quot;true&quot;</code>以及包含了<code>&lt;intent-filter&gt;</code>标签，这表明<code>MainActivity</code>是对外公开的、可由系统启动器识别并启动的用户界面入口点。对于大多数应用程序来说，主Activity是用户直接交互的第一个界面，可以说是用户视角的入口点。</li>
</ul>
<h5 id="adb-shell-pm-list-packages-3"><a href="#adb-shell-pm-list-packages-3" class="headerlink" title="adb shell pm list packages -3"></a>adb shell pm list packages -3</h5><p>命令 <code>adb shell pm list packages -3</code> 是在Android设备上通过ADB（Android Debug Bridge）查询所有已安装的第三方应用程序列表的操作。这里的 <code>-3</code> 参数告诉包管理器（Package Manager，简称pm）只显示第三方应用，即非系统预装的应用。当你执行这条命令时，ADB会连接到你的Android设备（确保你的设备已经开启开发者模式并连接到了电脑），然后列出所有用户安装的应用程序包名。</p>
<h5 id="adb-shell-dumpsys-window-findstr-mCurrentFocus"><a href="#adb-shell-dumpsys-window-findstr-mCurrentFocus" class="headerlink" title="adb shell dumpsys window | findstr mCurrentFocus"></a>adb shell dumpsys window | findstr mCurrentFocus</h5><p>用来查找当前在Android设备上获得焦点的应用窗口的信息。</p>
<p>这个题有两个方法把数据提出来，一个是使用frida</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">frida-dexdump -U -f <span class="hljs-keyword">com</span>.swdd.trustme<br></code></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405070131550.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240507013111462"></p>
<p>使用这个命令然后再用jadx查看提取出来的dex文件，即可以看到真正的MainActivity类</p>
<p>另一个则是因为题目中存在类似解压的操作，那么可以判断应该存在解包的文件，可以直接拖出来</p>
<p>先使用</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">adb</span> shell pm list packages -<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>

<p>获取所有包名</p>
<p>然后再</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss">adb <span class="hljs-built_in">shell</span> dumpsys <span class="hljs-built_in">window</span> | findstr mCurrentFocus<br></code></pre></td></tr></table></figure>

<p>可以获得真正的包名和入口点</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405070134247.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240507013431195"></p>
<p>得到</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">mCurrentFocus=Window&#123;bebbaf6 u0<br>com<span class="hljs-selector-class">.swdd</span>.trustme/com<span class="hljs-selector-class">.swdd</span><span class="hljs-selector-class">.tru5tme</span>.MainActivity&#125;<br></code></pre></td></tr></table></figure>

<p>所以可以去data目录里面去找</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell">adb shell<br><span class="hljs-built_in">cd</span> /<span class="hljs-keyword">data</span>/<span class="hljs-keyword">data</span>/com.swdd.trustme/app_payload_dex<br><span class="hljs-built_in">ls</span><br></code></pre></td></tr></table></figure>

<p>就可以在&#x2F;data&#x2F;data&#x2F;com.swdd.trustme&#x2F;app_payload_dex中找到脱壳出来的apk</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405070135874.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240507013554824"></p>
<p>最后使用adb pull出来</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs swift">adb pull <span class="hljs-regexp">/data/</span>data<span class="hljs-regexp">/com.swdd.trustme/</span>app_payload_dex<span class="hljs-operator">/</span>shell.apk <span class="hljs-string">&quot;D:<span class="hljs-subst">\t</span>mp&quot;</span><br></code></pre></td></tr></table></figure>

<p>而解密操作一个似乎是涉及到web的方法，一个是常规的逆向，异或0xFF回去即可，而有个思路很出人意外</p>
<p>因为db数据库文件中一般填充了大量的0x00，而这个打开却发现大多是0xFF,经猜测异或0xFF回去，解密</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs vim">import os,sys<br><span class="hljs-keyword">f</span>=<span class="hljs-keyword">open</span>(<span class="hljs-comment">&quot;</span><br>./mydb.db<span class="hljs-comment">&quot;</span><br>,<br><span class="hljs-string">&quot;rb&quot;</span>)<br>s=<span class="hljs-keyword">f</span>.<span class="hljs-keyword">read</span>()<br><span class="hljs-keyword">f</span>.<span class="hljs-keyword">close</span>()<br><span class="hljs-keyword">p</span>=<span class="hljs-keyword">b</span><span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> <span class="hljs-keyword">x</span> in s:<br><span class="hljs-keyword">p</span>+=chr(<span class="hljs-keyword">x</span>^<span class="hljs-number">0</span>xff).encode()<br><span class="hljs-keyword">f</span>=<span class="hljs-keyword">open</span>(<span class="hljs-comment">&quot;</span><br>./mydb.db<span class="hljs-comment">&quot;</span><br>,<br><span class="hljs-string">&quot;wb&quot;</span>)<br><span class="hljs-keyword">f</span>.<span class="hljs-keyword">write</span>(<span class="hljs-keyword">p</span>)<br><span class="hljs-keyword">f</span>.<span class="hljs-keyword">close</span>()<br></code></pre></td></tr></table></figure>

<p>strings一下字符串：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">C:\Users\Administrator\Desktop&gt;strings C:\Users\Administrator\Desktop\mydb.db<br>Strings v2<span class="hljs-number">.54</span> - <span class="hljs-keyword">Search</span> <span class="hljs-keyword">for</span> ANSI <span class="hljs-keyword">and</span> Unicode strings <span class="hljs-keyword">in</span> binary images.<br>Copyright (C) <span class="hljs-number">1999</span><span class="hljs-number">-2021</span> Mark Russinovich<br>Sysinternals - www.sysinternals.com<br>SQLite <span class="hljs-keyword">format</span> <span class="hljs-number">3</span><br>@<br>.O&#125;<br>Ytablesqlite_sequencesqlite_sequence<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> sqlite_sequence(<span class="hljs-type">name</span>,seq)<br>tableUserUser<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">User</span> (<br>id <span class="hljs-type">INTEGER</span> <span class="hljs-keyword">PRIMARY KEY</span> AUTOINCREMENT,<br>username <span class="hljs-type">TEXT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">UNIQUE</span>,<br><span class="hljs-keyword">password</span> <span class="hljs-type">TEXT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span><br>indexsqlite_autoindex_User_1User<br>AflagXYCTF&#123;And0r1d_15_V3ryEasy&#125;<br>adminqweradmin<br>flag<br><span class="hljs-keyword">admin</span><br><span class="hljs-keyword">User</span><br><br></code></pre></td></tr></table></figure>



<h2 id="何须相思煮余年"><a href="#何须相思煮余年" class="headerlink" title="何须相思煮余年"></a>何须相思煮余年</h2><p><a target="_blank" rel="noopener" href="https://defuse.ca/online-x86-assembler.htm%EF%BC%88%E8%BF%99%E9%87%8C%E6%94%BE%E4%B8%AA%E5%9C%A8%E7%BA%BF%E8%BD%AC%E6%8D%A2%E6%B1%87%E7%BC%96%E7%9A%84%E7%BD%91%E7%AB%99%EF%BC%89">https://defuse.ca/online-x86-assembler.htm（这里放个在线转换汇编的网站）</a></p>
<p>打开发现是一个txt文本，把数据转换成二进制形式</p>
<p>（这里扔个队友的脚本）</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dns">hex_data = &quot;<span class="hljs-number">0</span>x55 <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>xec <span class="hljs-number">0</span>x81 <span class="hljs-number">0</span>xec <span class="hljs-number">0</span>xa8 <span class="hljs-number">0x0 0x0</span> <span class="hljs-number">0</span>x0 <span class="hljs-number">0</span>xa1 <span class="hljs-number">0x0 0x40</span> <span class="hljs-number">0x41 0x0</span> <span class="hljs-number">0</span>x33 <span class="hljs-number">0</span>xc5 <span class="hljs-number">0x89 0x45</span> <span class="hljs-number">0</span>xfc <span class="hljs-number">0</span>x68 <span class="hljs-number">0</span>x9c <span class="hljs-number">0x0 0x0</span> <span class="hljs-number">0</span>x0 <span class="hljs-number">0</span>x6a <span class="hljs-number">0</span>x0 <span class="hljs-number">0</span>x8d <span class="hljs-number">0x85 0x60</span> <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x50 <span class="hljs-number">0</span>xe8 <span class="hljs-number">0</span>x7a <span class="hljs-number">0</span>xc <span class="hljs-number">0x0 0x0</span> <span class="hljs-number">0</span>x83 <span class="hljs-number">0</span>xc4 <span class="hljs-number">0</span>xc <span class="hljs-number">0</span>xc7 <span class="hljs-number">0x85 0x58</span> <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0x27 0x0</span> <span class="hljs-number">0x0 0x0</span> <span class="hljs-number">0</span>xc7 <span class="hljs-number">0</span>x85 <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0x0 0x0</span> <span class="hljs-number">0x0 0x0</span> <span class="hljs-number">0</span>xeb <span class="hljs-number">0</span>xf <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x8d <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x83 <span class="hljs-number">0</span>xc1 <span class="hljs-number">0x1 0x89</span> <span class="hljs-number">0</span>x8d <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x83 <span class="hljs-number">0</span>xbd <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x27 <span class="hljs-number">0</span>xf <span class="hljs-number">0</span>x8d <span class="hljs-number">0</span>xed <span class="hljs-number">0x0 0x0</span> <span class="hljs-number">0</span>x0 <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x95 <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x81 <span class="hljs-number">0</span>xe2 <span class="hljs-number">0x3 0x0</span> <span class="hljs-number">0x0 0x80</span> <span class="hljs-number">0x79 0x5</span> <span class="hljs-number">0</span>x4a <span class="hljs-number">0</span>x83 <span class="hljs-number">0</span>xca <span class="hljs-number">0</span>xfc <span class="hljs-number">0x42 0x85</span> <span class="hljs-number">0</span>xd2 <span class="hljs-number">0x75 0x25</span> <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x85 <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x8c <span class="hljs-number">0x85 0x60</span> <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x3 <span class="hljs-number">0</span>x8d <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x95 <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x89 <span class="hljs-number">0</span>x8c <span class="hljs-number">0x95 0x60</span> <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xe9 <span class="hljs-number">0</span>xac <span class="hljs-number">0x0 0x0</span> <span class="hljs-number">0</span>x0 <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x85 <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0x25 0x3</span> <span class="hljs-number">0x0 0x0</span> <span class="hljs-number">0x80 0x79</span> <span class="hljs-number">0x5 0x48</span> <span class="hljs-number">0</span>x83 <span class="hljs-number">0</span>xc8 <span class="hljs-number">0</span>xfc <span class="hljs-number">0x40 0x83</span> <span class="hljs-number">0</span>xf8 <span class="hljs-number">0x1 0x75</span> <span class="hljs-number">0</span>x22 <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x8d <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x94 <span class="hljs-number">0</span>x8d <span class="hljs-number">0</span>x60 <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x2b <span class="hljs-number">0</span>x95 <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x85 <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0x89 0x94</span> <span class="hljs-number">0x85 0x60</span> <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xeb <span class="hljs-number">0</span>x73 <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x8d <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x81 <span class="hljs-number">0</span>xe1 <span class="hljs-number">0x3 0x0</span> <span class="hljs-number">0x0 0x80</span> <span class="hljs-number">0x79 0x5</span> <span class="hljs-number">0x49 0x83</span> <span class="hljs-number">0</span>xc9 <span class="hljs-number">0</span>xfc <span class="hljs-number">0x41 0x83</span> <span class="hljs-number">0</span>xf9 <span class="hljs-number">0x2 0x75</span> <span class="hljs-number">0</span>x23 <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x95 <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x8b <span class="hljs-number">0x84 0x95</span> <span class="hljs-number">0</span>x60 <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xf <span class="hljs-number">0</span>xaf <span class="hljs-number">0</span>x85 <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x8d <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0x89 0x84</span> <span class="hljs-number">0</span>x8d <span class="hljs-number">0</span>x60 <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xeb <span class="hljs-number">0</span>x38 <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x95 <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x81 <span class="hljs-number">0</span>xe2 <span class="hljs-number">0x3 0x0</span> <span class="hljs-number">0x0 0x80</span> <span class="hljs-number">0x79 0x5</span> <span class="hljs-number">0</span>x4a <span class="hljs-number">0</span>x83 <span class="hljs-number">0</span>xca <span class="hljs-number">0</span>xfc <span class="hljs-number">0x42 0x83</span> <span class="hljs-number">0</span>xfa <span class="hljs-number">0x3 0x75</span> <span class="hljs-number">0</span>x20 <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x85 <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x8c <span class="hljs-number">0x85 0x60</span> <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x33 <span class="hljs-number">0</span>x8d <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x95 <span class="hljs-number">0</span>x5c <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x89 <span class="hljs-number">0</span>x8c <span class="hljs-number">0x95 0x60</span> <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xe9 <span class="hljs-number">0</span>xf7 <span class="hljs-number">0</span>xfe <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>xff <span class="hljs-number">0</span>x33 <span class="hljs-number">0</span>xc0 <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>x4d <span class="hljs-number">0</span>xfc <span class="hljs-number">0</span>x33 <span class="hljs-number">0</span>xcd <span class="hljs-number">0</span>xe8 <span class="hljs-number">0x4 0x0</span> <span class="hljs-number">0x0 0x0</span> <span class="hljs-number">0</span>x8b <span class="hljs-number">0</span>xe5 <span class="hljs-number">0</span>x5d <span class="hljs-number">0</span>xc3&quot;<br>\# 去除空格并将十六进制数据字符串分割成十六进制值的列表<br>hex_values = hex_data.split()<br>\# 将每个十六进制值转换为相应的整数值<br>int_values = [int(value, <span class="hljs-number">16</span>) for value in hex_values]<br>\# 将整数值列表转换为字节<br>binary_data = bytes(int_values)<br>\# 将二进制数据写入文件<br>with open(&quot;output&quot;, &quot;wb&quot;) as f:<br>  f.write(binary_data)<br></code></pre></td></tr></table></figure>

<p>将生成的文件拖入IDA,生成汇编指令</p>
<p>把两个call全部nop掉后生成伪代码</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404112321198.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240411232152127"></p>
<p>逆回去就行</p>
<p>XYCTF{5b3e07567a9034d06851475481507a75}</p>
<p>这里看别人的wp好像还有个思路</p>
<p>贴个脚本</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs llvm">from pwn import *<br>context.arch <span class="hljs-operator">=</span> &#x27;<span class="hljs-type">i386</span>&#x27;<br>code <span class="hljs-operator">=</span><br>b&#x27;\<span class="hljs-keyword">x</span><span class="hljs-number">55</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\xec\<span class="hljs-keyword">x</span><span class="hljs-number">81</span>\xec\xa<span class="hljs-number">8</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\xa<span class="hljs-number">1</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">40</span>\<span class="hljs-keyword">x</span><span class="hljs-number">41</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">33</span>\xc<span class="hljs-number">5</span>\<span class="hljs-keyword">x</span><span class="hljs-number">89</span>\<span class="hljs-keyword">x</span><br><span class="hljs-number">45</span>\xfc\<span class="hljs-keyword">x</span><span class="hljs-number">68</span>\<span class="hljs-keyword">x</span><span class="hljs-number">9</span><span class="hljs-keyword">c</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">6</span>a\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>d\<span class="hljs-keyword">x</span><span class="hljs-number">85</span>\<span class="hljs-keyword">x</span><span class="hljs-number">60</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">50</span>\xe<span class="hljs-number">8</span>\<span class="hljs-keyword">x</span><span class="hljs-number">7</span>a\<span class="hljs-keyword">x</span><br><span class="hljs-number">0</span><span class="hljs-keyword">c</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">83</span>\xc<span class="hljs-number">4</span>\<span class="hljs-keyword">x</span><span class="hljs-number">0</span><span class="hljs-keyword">c</span>\xc<span class="hljs-number">7</span>\<span class="hljs-keyword">x</span><span class="hljs-number">85</span>\<span class="hljs-keyword">x</span><span class="hljs-number">58</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">27</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\xc<span class="hljs-number">7</span>\<span class="hljs-keyword">x</span><span class="hljs-number">85</span>\<span class="hljs-keyword">x</span><br><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\xeb\<span class="hljs-keyword">x</span><span class="hljs-number">0</span>f\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>d\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">83</span>\xc<span class="hljs-number">1</span>\<span class="hljs-keyword">x</span><br><span class="hljs-number">01</span>\<span class="hljs-keyword">x</span><span class="hljs-number">89</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>d\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">83</span>\xbd\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">27</span>\<span class="hljs-keyword">x</span><span class="hljs-number">0</span>f\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>d\xed\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><br><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">95</span>\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">81</span>\xe<span class="hljs-number">2</span>\<span class="hljs-keyword">x</span><span class="hljs-number">03</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">80</span>\<span class="hljs-keyword">x</span><span class="hljs-number">79</span>\<span class="hljs-keyword">x</span><span class="hljs-number">05</span>\<span class="hljs-keyword">x</span><span class="hljs-number">4</span>a\<span class="hljs-keyword">x</span><span class="hljs-number">83</span>\<span class="hljs-keyword">x</span><br>ca\xfc\<span class="hljs-keyword">x</span><span class="hljs-number">42</span>\<span class="hljs-keyword">x</span><span class="hljs-number">85</span>\xd<span class="hljs-number">2</span>\<span class="hljs-keyword">x</span><span class="hljs-number">75</span>\<span class="hljs-keyword">x</span><span class="hljs-number">25</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">85</span>\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">8</span><span class="hljs-keyword">c</span>\<span class="hljs-keyword">x</span><span class="hljs-number">85</span>\<span class="hljs-keyword">x</span><span class="hljs-number">60</span>\xff\<span class="hljs-keyword">x</span><br>ff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">03</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>d\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">95</span>\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">89</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span><span class="hljs-keyword">c</span>\<span class="hljs-keyword">x</span><span class="hljs-number">95</span>\<span class="hljs-keyword">x</span><span class="hljs-number">60</span>\<span class="hljs-keyword">x</span><br>ff\xff\xff\xe<span class="hljs-number">9</span>\xac\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">85</span>\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">25</span>\<span class="hljs-keyword">x</span><span class="hljs-number">03</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><br><span class="hljs-number">80</span>\<span class="hljs-keyword">x</span><span class="hljs-number">79</span>\<span class="hljs-keyword">x</span><span class="hljs-number">05</span>\<span class="hljs-keyword">x</span><span class="hljs-number">48</span>\<span class="hljs-keyword">x</span><span class="hljs-number">83</span>\xc<span class="hljs-number">8</span>\xfc\<span class="hljs-keyword">x</span><span class="hljs-number">40</span>\<span class="hljs-keyword">x</span><span class="hljs-number">83</span>\xf<span class="hljs-number">8</span>\<span class="hljs-keyword">x</span><span class="hljs-number">01</span>\<span class="hljs-keyword">x</span><span class="hljs-number">75</span>\<span class="hljs-keyword">x</span><span class="hljs-number">22</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>d\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\<span class="hljs-keyword">x</span><br>ff\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">94</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>d\<span class="hljs-keyword">x</span><span class="hljs-number">60</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">2</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">95</span>\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">85</span>\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\<span class="hljs-keyword">x</span><br>ff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">89</span>\<span class="hljs-keyword">x</span><span class="hljs-number">94</span>\<span class="hljs-keyword">x</span><span class="hljs-number">85</span>\<span class="hljs-keyword">x</span><span class="hljs-number">60</span>\xff\xff\xff\xeb\<span class="hljs-keyword">x</span><span class="hljs-number">73</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>d\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">81</span>\<span class="hljs-keyword">x</span><br>e<span class="hljs-number">1</span>\<span class="hljs-keyword">x</span><span class="hljs-number">03</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">80</span>\<span class="hljs-keyword">x</span><span class="hljs-number">79</span>\<span class="hljs-keyword">x</span><span class="hljs-number">05</span>\<span class="hljs-keyword">x</span><span class="hljs-number">49</span>\<span class="hljs-keyword">x</span><span class="hljs-number">83</span>\xc<span class="hljs-number">9</span>\xfc\<span class="hljs-keyword">x</span><span class="hljs-number">41</span>\<span class="hljs-keyword">x</span><span class="hljs-number">83</span>\xf<span class="hljs-number">9</span>\<span class="hljs-keyword">x</span><span class="hljs-number">02</span>\<span class="hljs-keyword">x</span><span class="hljs-number">75</span>\<span class="hljs-keyword">x</span><span class="hljs-number">23</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><br><span class="hljs-number">95</span>\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">84</span>\<span class="hljs-keyword">x</span><span class="hljs-number">95</span>\<span class="hljs-keyword">x</span><span class="hljs-number">60</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">0</span>f\xaf\<span class="hljs-keyword">x</span><span class="hljs-number">85</span>\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\<span class="hljs-keyword">x</span><br>ff\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>d\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">89</span>\<span class="hljs-keyword">x</span><span class="hljs-number">84</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>d\<span class="hljs-keyword">x</span><span class="hljs-number">60</span>\xff\xff\xff\xeb\<span class="hljs-keyword">x</span><span class="hljs-number">38</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">95</span>\<span class="hljs-keyword">x</span><br><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">81</span>\xe<span class="hljs-number">2</span>\<span class="hljs-keyword">x</span><span class="hljs-number">03</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">80</span>\<span class="hljs-keyword">x</span><span class="hljs-number">79</span>\<span class="hljs-keyword">x</span><span class="hljs-number">05</span>\<span class="hljs-keyword">x</span><span class="hljs-number">4</span>a\<span class="hljs-keyword">x</span><span class="hljs-number">83</span>\xca\xfc\<span class="hljs-keyword">x</span><span class="hljs-number">42</span>\<span class="hljs-keyword">x</span><span class="hljs-number">83</span>\<span class="hljs-keyword">x</span><br>fa\<span class="hljs-keyword">x</span><span class="hljs-number">03</span>\<span class="hljs-keyword">x</span><span class="hljs-number">75</span>\<span class="hljs-keyword">x</span><span class="hljs-number">20</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">85</span>\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">8</span><span class="hljs-keyword">c</span>\<span class="hljs-keyword">x</span><span class="hljs-number">85</span>\<span class="hljs-keyword">x</span><span class="hljs-number">60</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">33</span>\<span class="hljs-keyword">x</span><br><span class="hljs-number">8</span>d\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">95</span>\<span class="hljs-keyword">x</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>\xff\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">89</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span><span class="hljs-keyword">c</span>\<span class="hljs-keyword">x</span><span class="hljs-number">95</span>\<span class="hljs-keyword">x</span><span class="hljs-number">60</span>\xff\xff\xff\<span class="hljs-keyword">x</span><br>e<span class="hljs-number">9</span>\xf<span class="hljs-number">7</span>\xfe\xff\xff\<span class="hljs-keyword">x</span><span class="hljs-number">33</span>\xc<span class="hljs-number">0</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><span class="hljs-number">4</span>d\xfc\<span class="hljs-keyword">x</span><span class="hljs-number">33</span>\xcd\xe<span class="hljs-number">8</span>\<span class="hljs-keyword">x</span><span class="hljs-number">04</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>b\<span class="hljs-keyword">x</span><br>e<span class="hljs-number">5</span>\<span class="hljs-keyword">x</span><span class="hljs-number">5</span>d\xc<span class="hljs-number">3</span>&#x27;<br>assembly <span class="hljs-operator">=</span> disasm(code)<br>print(assembly)<br></code></pre></td></tr></table></figure>



<h2 id="砸核桃"><a href="#砸核桃" class="headerlink" title="砸核桃"></a>砸核桃</h2><p>先找工具脱个壳</p>
<p>网上能找到的是能脱3.几的版本的</p>
<p>打开以后直接看逻辑写脚本即可</p>
<p>（注意字符类型）</p>
<h2 id="今夕是何年"><a href="#今夕是何年" class="headerlink" title="今夕是何年"></a>今夕是何年</h2><p>懒得配了，贴点官方的</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">main</span>: ELF <span class="hljs-number">64</span>-bit LSB executable, LoongArch, version <span class="hljs-number">1</span> (GNU/Linux), statically linked,<br><span class="hljs-attribute">BuildID</span>[sha1]=d5e0c55633e219eba65de1d09a45173c22668739, for GNU/Linux <span class="hljs-number">5</span>.<span class="hljs-number">19</span>.<span class="hljs-number">0</span>,<br><span class="hljs-attribute">with</span> debug_info, not stripped<br></code></pre></td></tr></table></figure>

<p>可以看到这是一个 LoongArch 架构的 ELF 二进制文件，所以我们需要一个 LoongArch 架构的 环境来运行这个文件。当然，你可以真的买一块 LoongArch 架构的 CPU（如龙芯 3A6000）来 运行这个程序，但是更方便的做法是使用 QEMU，一个可以仿真各种架构的虚拟机程序。 顺便一提，如果你真的选择买一块龙芯 CPU 来运行这个程序的话，你多半会遇到新世界和旧世界 的兼容性问题。这个文件是一个新世界程序，所以需要新世界的操作系统来运行，如果你使用旧 世界的操作系统（如此时此刻的 Loongnix 和 UOS），那么这个程序是无法运行的。 如果你想详细了解这方面，推荐阅读 <a target="_blank" rel="noopener" href="https://areweloongyet.com/docs/old-and-new-worlds/%E7%9A%84%E7%9B%B8%E5%85%B3%E8%B5%84%E6%96%99%E3%80%82">https://areweloongyet.com/docs/old-and-new-worlds/的相关资料。</a> QEMU 分为用户态和系统态两种模式。因为 main 是一个静态编译的二进制文件（你可以使用 ldd 得知这一点），你只需要使用用户态就可以完成这道题了。首先，你需要一个 Linux 环境 （只要 x86-64 就可以了），你可以通过搜索引擎或文档来查询如何在你使用的 Linux 发行版上 配置用户态的 QEMU。对于 Kali Linux 来说，你需要安装 qemu-user 软件包，然后只需要给 main 文件加上可执行权限，再使用 .&#x2F;main 运行就可以得到 flag 了。 当然，你也可以使用系统态的 QEMU 完成这道题，但是我没有试过。如果你有兴趣可以自行尝 试 </p>
<p>kali指令如下： </p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">apt install qemu-<span class="hljs-keyword">user</span><br><br> <span class="hljs-title">chmod</span> <span class="hljs-number">777</span> ./*<br><br> ./main<br></code></pre></td></tr></table></figure>



<h2 id="简爱"><a href="#简爱" class="headerlink" title="简爱"></a>简爱</h2><p>IDA打开以后发现没有办法进行调试，在kali上面运行发现</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404202200097.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240420220051991"></p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404202212111.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload></p>
<p>经过搜索发现 LSB relocatable为可重定位文件，经过分析发现是.o文件</p>
<p>在kali上面gcc -o 目标文件名 待执行文件 </p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404202210722.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240420221009694"></p>
<p>然后运行发现可以执行了(可调试)</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404232059673.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240423205901567"></p>
<p>然后发现其实上面两个加密函数并没有起任何作用（最后拿高版本的IDA开，发现最开始做的时候白分析了上面两个加密函数，错付了……）直接相当于howtolove对输入字符进行加密</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404232114151.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240423211401090"></p>
<p>查看函数</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404232115029.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240423211519979"></p>
<p>可以考虑先复刻一遍加密逻辑然后在加密的代码里面的时候打印出解密脚本</p>
<p>这个地方注意count1 和 count2 即为将循环结束后flag被++的次数</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br></pre></td><td class="code"><pre><code class="hljs smali">\<span class="hljs-comment">#include &lt;stdio.h&gt;</span><br> \<span class="hljs-comment">#include &lt;string.h&gt;</span><br> \<span class="hljs-comment">#include &lt;stdlib.h&gt;</span><br> \<span class="hljs-comment">#include &lt;time.h&gt;</span><br><br> \<span class="hljs-comment">#define MAX_BUFFER_SIZE 512</span><br> \<span class="hljs-comment">#define MAX_FILENAME_LENGTH 40</span><br><br> char box[MAX_BUFFER_SIZE];<br> char FileNamein[MAX_FI<span class="hljs-class">LENAME_LENGTH];</span><br> char Filenameout[MAX_FI<span class="hljs-class">LENAME_LENGTH];</span><br><br><span class="hljs-built_in"> int </span>howtolove(char *flag)<br> &#123;<br>  <span class="hljs-built_in"> int </span>v2[1802];<br>  <span class="hljs-built_in"> int </span>v3;<br>  <span class="hljs-built_in"> int </span>v4;<br>  <span class="hljs-built_in"> int </span>count1, count2;<br><br>   memset(v2, 0, sizeof(v2));<br><br>   // Initialize elements of v2<span class="hljs-built_in"> array</span><br><span class="hljs-built_in"></span>   v2[32] = 2;<br>   v2[65] = 2;<br>   v2[66] = 4;<br>   v2[98] = 2;<br>   v2[99] = 5;<br>   v2[185] = 2;<br>   v2[186] = 2;<br>   v2[187] = 1;<br>   v2[188] = 1;<br>   v2[189] = 1;<br>   v2[190] = 1;<br>   v2[191] = 1;<br>   v2[192] = 1;<br>   v2[193] = 1;<br>   v2[194] = 1;<br>   v2[195] = 1;<br>   v2[196] = 1;<br>   v2[197] = 1;<br>   v2[198] = 1;<br>   v2[199] = 1;<br>   v2[200] = 1;<br>   v2[201] = 1;<br>   v2[202] = 1;<br>   v2[203] = 1;<br>   v2[204] = 1;<br>   v2[205] = 1;<br>   v2[206] = 1;<br>   v2[207] = 1;<br>   v2[208] = 1;<br>   v2[209] = 1;<br>   v2[210] = 1;<br>   v2[211] = 1;<br>   v2[212] = 1;<br>   v2[213] = 1;<br>   v2[214] = 1;<br>   v2[215] = 1;<br>   v2[216] = 1;<br>   v2[217] = 1;<br>   v2[218] = 1;<br>   v2[219] = 1;<br>   v2[220] = 1;<br>   v2[221] = 1;<br>   v2[222] = 1;<br>   v2[223] = 1;<br>   v2[224] = 1;<br>   v2[225] = 1;<br>   v2[226] = 1;<br>   v2[227] = 1;<br>   v2[228] = 1;<br>   v2[229] = 2;<br>   v2[232] = 2;<br>   v2[256] = 2;<br>   v2[257] = 5;<br>   v2[303] = 1;<br>   v2[304] = 1;<br>   v2[305] = 1;<br>   v2[306] = 1;<br>   v2[307] = 2;<br>   v2[308] = 5;<br>   v2[328] = 1;<br>   v2[329] = 1;<br>   v2[330] = 1;<br>   v2[331] = 1;<br>   v2[332] = 1;<br>   v2[333] = 1;<br>   v2[334] = 1;<br>   v2[335] = 1;<br>   v2[336] = 1;<br>   v2[337] = 1;<br>   v2[338] = 1;<br>   v2[339] = 1;<br>   v2[340] = 1;<br>   v2[341] = 1;<br>   v2[342] = 2;<br>   v2[353] = 2;<br>   v2[354] = 5;<br>   v2[430] = 2;<br>   v2[431] = 2;<br>   v2[432] = 5;<br>   v2[523] = 2;<br>   v2[524] = 5;<br>   v2[564] = 2;<br>   v2[565] = 5;<br>   v2[627] = 2;<br>   v2[628] = 1;<br>   v2[629] = 1;<br>   v2[630] = 1;<br>   v2[631] = 1;<br>   v2[632] = 1;<br>   v2[633] = 1;<br>   v2[634] = 1;<br>   v2[635] = 1;<br>   v2[636] = 1;<br>   v2[637] = 1;<br>   v2[638] = 1;<br>   v2[639] = 1;<br>   v2[640] = 1;<br>   v2[641] = 1;<br>   v2[642] = 1;<br>   v2[643] = 1;<br>   v2[644] = 1;<br>   v2[645] = 1;<br>   v2[646] = 1;<br>   v2[647] = 2;<br>   v2[648] = 4;<br>   v2[649] = 1;<br>   v2[650] = 1;<br>   v2[651] = 1;<br>   v2[652] = 1;<br>   v2[653] = 2;<br>   v2[680] = 2;<br>   v2[687] = 2;<br>   v2[688] = 4;<br>   v2[698] = 2;<br>   v2[766] = 2;<br>   v2[767] = 5;<br>   v2[818] = 2;<br>   v2[819] = 1;<br>   v2[820] = 2;<br>   v2[827] = 2;<br>   v2[828] = 5;<br>   v2[846] = 2;<br>   v2[847] = 5;<br>   v2[890] = 2;<br>   v2[891] = 1;<br>   v2[892] = 1;<br>   v2[893] = 1;<br>   v2[894] = 1;<br>   v2[895] = 1;<br>   v2[896] = 1;<br>   v2[897] = 1;<br>   v2[898] = 1;<br>   v2[899] = 1;<br>   v2[900] = 1;<br>   v2[901] = 1;<br>   v2[902] = 1;<br>   v2[903] = 1;<br>   v2[904] = 1;<br>   v2[905] = 1;<br>   v2[906] = 1;<br>   v2[907] = 1;<br>   v2[908] = 1;<br>   v2[909] = 1;<br>   v2[910] = 1;<br>   v2[911] = 1;<br>   v2[912] = 1;<br>   v2[913] = 1;<br>   v2[914] = 1;<br>   v2[915] = 1;<br>   v2[916] = 1;<br>   v2[917] = 1;<br>   v2[918] = 1;<br>   v2[919] = 1;<br>   v2[920] = 1;<br>   v2[921] = 1;<br>   v2[922] = 1;<br>   v2[923] = 1;<br>   v2[924] = 1;<br>   v2[925] = 1;<br>   v2[926] = 1;<br>   v2[927] = 1;<br>   v2[928] = 1;<br>   v2[929] = 1;<br>   v2[930] = 1;<br>   v2[931] = 1;<br>   v2[932] = 1;<br>   v2[933] = 2;<br>   v2[934] = 5;<br>   v2[989] = 2;<br>   v2[994] = 2;<br>   v2[995] = 1;<br>   v2[996] = 1;<br>   v2[997] = 1;<br>   v2[998] = 1;<br>   v2[999] = 1;<br>   v2[1000] = 1;<br>   v2[1001] = 1;<br>   v2[1002] = 1;<br>   v2[1003] = 1;<br>   v2[1013] = 1;<br>   v2[1014] = 1;<br>   v2[1015] = 1;<br>   v2[1016] = 1;<br>   v2[1017] = 1;<br>   v2[1018] = 1;<br>   v2[1019] = 1;<br>   v2[1020] = 1;<br>   v2[1021] = 1;<br>   v2[1022] = 1;<br>   v2[1023] = 1;<br>   v2[1024] = 1;<br>   v2[1025] = 1;<br>   v2[1026] = 1;<br>   v2[1027] = 2;<br>   v2[1028] = 3;<br><br>   v4 = 0;<br>   v3 = 0;<br><br>   while (1)<br>   &#123;<br>     while (1)<br>     &#123;<br>       count2 = 0;<br>       while (1)<br>       &#123;<br>         count1 = 0;<br>         while (!v2[v3])<br>         &#123;<br>           v3++;<br>           ++flag[v4];<br>           count1++;<br>         &#125;<br>        <span class="hljs-built_in"> if </span>(count1 != 0)<br>         &#123;<br>           printf(<span class="hljs-string">&quot;flag[%d] -= %d;\n&quot;</span>, v4, count1);<br>         &#125;<br>        <span class="hljs-built_in"> if </span>(v2[v3] != 1)<br>           break;<br>         v3++;<br>         count2++;<br>         --flag[v4];<br>       &#125;<br>      <span class="hljs-built_in"> if </span>(count2 != 0)<br>       &#123;<br>         printf(<span class="hljs-string">&quot;flag[%d] += %d;\n&quot;</span>, v4, count2);<br>       &#125;<br>      <span class="hljs-built_in"> if </span>(v2[v3] != 2)<br>         break;<br>       ++v3;<br>       ++v4;<br>       &#125;<br>    <span class="hljs-built_in"> if </span>( v2[v3]==3) <br>       break;<br>      <span class="hljs-built_in"> if </span>( v2[v3]==4)<br>         &#123;<br>           flag[v4] = flag[v4] + flag[v4 + 1] - 70;<br>           printf(<span class="hljs-string">&quot;flag[%d] = flag[%d] + 70 - flag[%d];\n&quot;</span>,v4,v4,v4+1);<br>           ++v3;<br>         &#125;<br>         else<span class="hljs-built_in"> if </span>( v2[v3]==5)<br>           &#123;<br>             flag[v4] = flag[v4] - flag[v4 + 1] + 70;<br>             printf(<span class="hljs-string">&quot;flag[%d] = flag[%d] - 70 + flag[%d];\n&quot;</span>,v4,v4,v4+1);<br>             ++v3;<br>           &#125;<br>   &#125;<br>  <span class="hljs-built_in"> return </span>0;<br> &#125;<br><span class="hljs-built_in"> int </span>main()<br> &#123;<br>   char flag[33] = <span class="hljs-string">&quot;flag&#123;Love_is_not_one_sided_Love&#125;&quot;</span>;<br>   howtolove(flag);<br>  <span class="hljs-built_in"> return </span>0;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>打印出结果</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404232118153.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240423211845045"></p>
<p>这个即为解密逻辑，调整一下代码顺序即可</p>
<p>注意一下这种</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404232126626.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240423212629581"></p>
<figure class="highlight stan"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stan">\<span class="hljs-meta">#include <span class="hljs-string">int</span> <span class="hljs-string">main</span>()&#123; <span class="hljs-string">unsigned</span> <span class="hljs-string">char</span> <span class="hljs-string">flag</span>[] = &quot;<span class="hljs-string">flag</span>&#123;L<span class="hljs-string">ove_is_not_one_sided_</span>L<span class="hljs-string">ove</span>&#125;&quot;; <span class="hljs-string">flag</span>[28] -= 54; <span class="hljs-string">flag</span>[29] -= 4; <span class="hljs-string">flag</span>[30] -= 9; <span class="hljs-string">flag</span>[30] += 23; <span class="hljs-string">flag</span>[28] = <span class="hljs-string">flag</span>[28] - 70 + <span class="hljs-string">flag</span>[29]; <span class="hljs-string">flag</span>[26] -= 42; <span class="hljs-string">flag</span>[27] += 42; <span class="hljs-string">flag</span>[26] = <span class="hljs-string">flag</span>[26] - 70 + <span class="hljs-string">flag</span>[27]; <span class="hljs-string">flag</span>[25] -= 17; <span class="hljs-string">flag</span>[25] = <span class="hljs-string">flag</span>[25] - 70 + <span class="hljs-string">flag</span>[26]; <span class="hljs-string">flag</span>[22] -= 50; <span class="hljs-string">flag</span>[23] += 1; <span class="hljs-string">flag</span>[24] -= 6; <span class="hljs-string">flag</span>[22] = <span class="hljs-string">flag</span>[22] - 70 + <span class="hljs-string">flag</span>[23]; <span class="hljs-string">flag</span>[20] -= 9; <span class="hljs-string">flag</span>[21] -= 67; <span class="hljs-string">flag</span>[20] = <span class="hljs-string">flag</span>[20] + 70 - <span class="hljs-string">flag</span>[21]; <span class="hljs-string">flag</span>[17] += 4; <span class="hljs-string">flag</span>[18] -= 26; <span class="hljs-string">flag</span>[19] -= 6; <span class="hljs-string">flag</span>[17] = <span class="hljs-string">flag</span>[17] + 70 - <span class="hljs-string">flag</span>[18]; <span class="hljs-string">flag</span>[15] -= 61; <span class="hljs-string">flag</span>[16] += 19; <span class="hljs-string">flag</span>[15] = <span class="hljs-string">flag</span>[15] - 70 + <span class="hljs-string">flag</span>[16]; <span class="hljs-string">flag</span>[14] -= 39; <span class="hljs-string">flag</span>[14] = <span class="hljs-string">flag</span>[14] - 70 + <span class="hljs-string">flag</span>[15]; <span class="hljs-string">flag</span>[13] -= 90; <span class="hljs-string">flag</span>[13] = (<span class="hljs-string">flag</span>[13]+256)%256; <span class="hljs-string">flag</span>[11] -= 75; <span class="hljs-string">flag</span>[11] = <span class="hljs-string">flag</span>[11] - 70 + <span class="hljs-string">flag</span>[12]; <span class="hljs-string">flag</span>[9] -= 19; <span class="hljs-string">flag</span>[9] += 14; <span class="hljs-string">flag</span>[10] -= 10; <span class="hljs-string">flag</span>[9] = <span class="hljs-string">flag</span>[9] - 70 + <span class="hljs-string">flag</span>[10]; <span class="hljs-string">flag</span>[8] -= 45; <span class="hljs-string">flag</span>[8] += 4; <span class="hljs-string">flag</span>[8] = <span class="hljs-string">flag</span>[8] - 70 + <span class="hljs-string">flag</span>[9]; <span class="hljs-string">flag</span>[3] -= 85; <span class="hljs-string">flag</span>[5] += 42; <span class="hljs-string">flag</span>[6] -= 2; <span class="hljs-string">flag</span>[7] -= 23; <span class="hljs-string">flag</span>[3] = <span class="hljs-string">flag</span>[3] - 70 + <span class="hljs-string">flag</span>[4]; <span class="hljs-string">flag</span>[2] -= 31; <span class="hljs-string">flag</span>[2] = <span class="hljs-string">flag</span>[2] + 70 - <span class="hljs-string">flag</span>[3]; <span class="hljs-string">flag</span>[1] -= 32; <span class="hljs-string">flag</span>[0] -= 32; <span class="hljs-string">int</span> i = 0; <span class="hljs-string">for</span> (;i&lt;32;i ) <span class="hljs-string">printf</span>(&quot;%c&quot;,<span class="hljs-string">flag</span>[i]); <span class="hljs-string">return</span> 0; &#125;</span><br><br><br></code></pre></td></tr></table></figure>







<h2 id="ezmath"><a href="#ezmath" class="headerlink" title="ezmath"></a>ezmath</h2><p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281409750.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240428140957713"></p>
<p>使用pyinstxtractor进行python的解包，反编译（py文件和题目放同一个路径哈）</p>
<p>可以打开IDA在字符串界面看看，含py字样</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281517732.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240428151714594"></p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281412868.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240428141222826"></p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281413883.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240428141328828"></p>
<p>找到题目相同名字的pyc文件</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202404281416906.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload></p>
<p> sum([flag[23] for _ in range(flag[23])])：</p>
<p>这是一个列表推导式，它创建了一个新列表，其中包含了<code>flag[23]</code>这个值重复<code>flag[23]</code>次。也就是说，如果<code>flag[23]</code>的值是<code>n</code>，那么这个新列表就会有<code>n</code>个<code>n</code>。即为n*n</p>
<p>这一大堆东西整理出来应该是</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">(flag<span class="hljs-selector-attr">[i]</span>*flag<span class="hljs-selector-attr">[i]</span>)<span class="hljs-built_in">-</span>(flag<span class="hljs-selector-attr">[i]</span>*num)<br></code></pre></td></tr></table></figure>

<p>配个方然后发现297412符合，可以直接flag[i]的值</p>
<p>这个题我们拿z3跑出来的</p>
<p>看到群里说Int型是跑不出来的，要用real</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs gcode">real型的<br>from z<span class="hljs-number">3</span> import * <span class="hljs-attr"># 创建⼀个Z3</span>求解器 <br>solver = Solver<span class="hljs-comment">()</span> <span class="hljs-attr"># 定义32</span>个<span class="hljs-number">32</span>位的变量 <br>fla<span class="hljs-name">g0</span> = Real<span class="hljs-comment">(&#x27;flag0&#x27;)</span><br>fla<span class="hljs-name">g1</span> = Real<span class="hljs-comment">(&#x27;flag1&#x27;)</span> <br>fla<span class="hljs-name">g2</span> = Real<span class="hljs-comment">(&#x27;flag2&#x27;)</span> <br>fla<span class="hljs-name">g3</span> = Real<span class="hljs-comment">(&#x27;flag3&#x27;)</span><br>fla<span class="hljs-name">g4</span> = Real<span class="hljs-comment">(&#x27;flag4&#x27;)</span> <br>fla<span class="hljs-name">g5</span> = Real<span class="hljs-comment">(&#x27;flag5&#x27;)</span> <br>fla<span class="hljs-name">g6</span> = Real<span class="hljs-comment">(&#x27;flag6&#x27;)</span> <br>fla<span class="hljs-name">g7</span> = Real<span class="hljs-comment">(&#x27;flag7&#x27;)</span><br>fla<span class="hljs-name">g8</span> = Real<span class="hljs-comment">(&#x27;flag8&#x27;)</span> <br>fla<span class="hljs-name">g9</span> = Real<span class="hljs-comment">(&#x27;flag9&#x27;)</span> <br>fla<span class="hljs-name">g10</span> = Real<span class="hljs-comment">(&#x27;flag10&#x27;)</span> <br>fla<span class="hljs-name">g11</span> = Real<span class="hljs-comment">(&#x27;flag11&#x27;)</span> <br>fla<span class="hljs-name">g12</span> = Real<span class="hljs-comment">(&#x27;flag12&#x27;)</span><br>fla<span class="hljs-name">g13</span> = Real<span class="hljs-comment">(&#x27;flag13&#x27;)</span><br>fla<span class="hljs-name">g14</span> = Real<span class="hljs-comment">(&#x27;flag14&#x27;)</span> <br>fla<span class="hljs-name">g15</span> = Real<span class="hljs-comment">(&#x27;flag15&#x27;)</span><br>fla<span class="hljs-name">g16</span> = Real<span class="hljs-comment">(&#x27;flag16&#x27;)</span><br>fla<span class="hljs-name">g17</span> = Real<span class="hljs-comment">(&#x27;flag17&#x27;)</span><br>fla<span class="hljs-name">g18</span> = Real<span class="hljs-comment">(&#x27;flag18&#x27;)</span><br>fla<span class="hljs-name">g19</span> = Real<span class="hljs-comment">(&#x27;flag19&#x27;)</span><br>fla<span class="hljs-name">g20</span> = Real<span class="hljs-comment">(&#x27;flag20&#x27;)</span><br>fla<span class="hljs-name">g21</span> = Real<span class="hljs-comment">(&#x27;flag21&#x27;)</span><br>fla<span class="hljs-name">g22</span> = Real<span class="hljs-comment">(&#x27;flag22&#x27;)</span><br>fla<span class="hljs-name">g23</span> = Real<span class="hljs-comment">(&#x27;flag23&#x27;)</span><br>fla<span class="hljs-name">g24</span> = Real<span class="hljs-comment">(&#x27;flag24&#x27;)</span><br>fla<span class="hljs-name">g25</span> = Real<span class="hljs-comment">(&#x27;flag25&#x27;)</span><br>fla<span class="hljs-name">g26</span> = Real<span class="hljs-comment">(&#x27;flag26&#x27;)</span><br>fla<span class="hljs-name">g27</span> = Real<span class="hljs-comment">(&#x27;flag27&#x27;)</span><br>fla<span class="hljs-name">g28</span> = Real<span class="hljs-comment">(&#x27;flag28&#x27;)</span><br>fla<span class="hljs-name">g29</span> = Real<span class="hljs-comment">(&#x27;flag29&#x27;)</span><br>fla<span class="hljs-name">g30</span> = Real<span class="hljs-comment">(&#x27;flag30&#x27;)</span><br>fla<span class="hljs-name">g31</span> = Real<span class="hljs-comment">(&#x27;flag31&#x27;)</span><br>solver.add<span class="hljs-comment">((flag23 * flag23)</span> + <span class="hljs-comment">(flag12 * flag12)</span> + <span class="hljs-comment">(flag1 * flag1)</span> -<br><span class="hljs-comment">(222 * flag24)</span> + <span class="hljs-comment">(flag22 * flag22)</span> + <span class="hljs-comment">(flag31 * flag31)</span> + <span class="hljs-comment">(flag26 *</span><br><span class="hljs-comment">flag26)</span> - <span class="hljs-comment">(178 * flag9)</span> - <span class="hljs-comment">(232 * flag29)</span> + <span class="hljs-comment">(flag17 * flag17)</span> - <span class="hljs-comment">(150 *</span><br><span class="hljs-comment">flag23)</span> - <span class="hljs-comment">(226 * flag6)</span> - <span class="hljs-comment">(110 * flag7)</span> + <span class="hljs-comment">(flag19 * flag19)</span> + <span class="hljs-comment">(flag2 *</span><br><span class="hljs-comment">flag2)</span> - <span class="hljs-comment">(176 * flag0)</span> + <span class="hljs-comment">(flag10 * flag10)</span> - <span class="hljs-comment">(198 * flag12)</span> + <span class="hljs-comment">(flag24 *</span><br><span class="hljs-comment">flag24)</span> + <span class="hljs-comment">(flag9 * flag9)</span> - <span class="hljs-comment">(168 * flag3)</span> + <span class="hljs-comment">(flag8 * flag8)</span> - <span class="hljs-comment">(134 *</span><br><span class="hljs-comment">flag2)</span> + <span class="hljs-comment">(flag14 * flag14)</span> - <span class="hljs-comment">(170 * flag13)</span> + <span class="hljs-comment">(flag4 * flag4)</span> - <span class="hljs-comment">(142 *</span><br><span class="hljs-comment">flag10)</span> + <span class="hljs-comment">(flag27 * flag27)</span> + <span class="hljs-comment">(flag15 * flag15)</span> - <span class="hljs-comment">(224 * flag15)</span> +<br><span class="hljs-comment">(flag16 * flag16)</span> - <span class="hljs-comment">(230 * flag11)</span> - <span class="hljs-comment">(178 * flag1)</span> + <span class="hljs-comment">(flag28 * flag28)</span> -<br><span class="hljs-comment">(246 * flag5)</span> - <span class="hljs-comment">(168 * flag17)</span> + <span class="hljs-comment">(flag30 * flag30)</span> - <span class="hljs-comment">(220 * flag21)</span> -<br><span class="hljs-comment">(212 * flag22)</span> - <span class="hljs-comment">(232 * flag16)</span> + <span class="hljs-comment">(flag25 * flag25)</span> - <span class="hljs-comment">(140 * flag4)</span> -<br><span class="hljs-comment">(250 * flag31)</span> - <span class="hljs-comment">(150 * flag28)</span> + <span class="hljs-comment">(flag11 * flag11)</span> + <span class="hljs-comment">(flag13 * flag13)</span><br>- <span class="hljs-comment">(234 * flag14)</span> + <span class="hljs-comment">(flag7 * flag7)</span> - <span class="hljs-comment">(174 * flag8)</span> + <span class="hljs-comment">(flag3 * flag3)</span> -<br><span class="hljs-comment">(242 * flag25)</span> + <span class="hljs-comment">(flag29 * flag29)</span> + <span class="hljs-comment">(flag5 * flag5)</span> - <span class="hljs-comment">(142 * flag30)</span> -<br><span class="hljs-comment">(170 * flag26)</span> - <span class="hljs-comment">(176 * flag19)</span> + <span class="hljs-comment">(flag0 * flag0)</span> - <span class="hljs-comment">(168 * flag27)</span> +<br><span class="hljs-comment">(flag20 * flag20)</span> - <span class="hljs-comment">(212 * flag20)</span> + <span class="hljs-comment">(flag21 * flag21)</span> + <span class="hljs-comment">(flag6 * flag6)</span><br>+ <span class="hljs-comment">(flag18 * flag18)</span> - <span class="hljs-comment">(178 * flag18)</span> + <span class="hljs-number">297412</span> == <span class="hljs-number">0</span>)<br><span class="hljs-attr"># 检查是否存在解</span><br><span class="hljs-attr">if solver.check() == sat:</span><br><span class="hljs-attr"># 获取解</span><br><span class="hljs-attr">model = solver.model()</span><br><span class="hljs-attr">print(model)</span><br><span class="hljs-attr">else:</span><br><span class="hljs-attr">print(&quot;No solution&quot;)</span><br></code></pre></td></tr></table></figure>

<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs prolog"><span class="hljs-symbol">Int</span>型的<br>from z3.z3 import <span class="hljs-symbol">Int</span>, <span class="hljs-symbol">Solver</span>, sat<br>flag = [<span class="hljs-symbol">Int</span>(f<span class="hljs-string">&quot;flag[&#123;i&#125;]&quot;</span>) for i in range(<span class="hljs-number">32</span>)]<br>solver = <span class="hljs-symbol">Solver</span>()<br>solver.add(<br>flag[<span class="hljs-number">23</span>] * (flag[<span class="hljs-number">23</span>]) +<br>flag[<span class="hljs-number">12</span>] * (flag[<span class="hljs-number">12</span>]) +<br>flag[<span class="hljs-number">1</span>] * (flag[<span class="hljs-number">1</span>]) -<br>flag[<span class="hljs-number">24</span>] * <span class="hljs-number">222</span> +<br>flag[<span class="hljs-number">22</span>] * (flag[<span class="hljs-number">22</span>]) +<br>flag[<span class="hljs-number">31</span>] * (flag[<span class="hljs-number">31</span>]) +<br>flag[<span class="hljs-number">26</span>] * (flag[<span class="hljs-number">26</span>]) -<br>flag[<span class="hljs-number">9</span>] * <span class="hljs-number">178</span> -<br>flag[<span class="hljs-number">29</span>] * <span class="hljs-number">232</span> +<br>flag[<span class="hljs-number">17</span>] * (flag[<span class="hljs-number">17</span>]) -<br>flag[<span class="hljs-number">23</span>] * <span class="hljs-number">150</span> -<br>flag[<span class="hljs-number">6</span>] * <span class="hljs-number">226</span> -<br>flag[<span class="hljs-number">7</span>] * <span class="hljs-number">110</span> +<br>flag[<span class="hljs-number">19</span>] * (flag[<span class="hljs-number">19</span>]) +<br>flag[<span class="hljs-number">2</span>] * (flag[<span class="hljs-number">2</span>]) -<br>flag[<span class="hljs-number">0</span>] * <span class="hljs-number">176</span> +<br>flag[<span class="hljs-number">10</span>] * (flag[<span class="hljs-number">10</span>]) -<br>flag[<span class="hljs-number">12</span>] * <span class="hljs-number">198</span> +<br>flag[<span class="hljs-number">24</span>] * (flag[<span class="hljs-number">24</span>]) +<br>flag[<span class="hljs-number">9</span>] * (flag[<span class="hljs-number">9</span>]) -<br>flag[<span class="hljs-number">3</span>] * <span class="hljs-number">168</span> +<br>flag[<span class="hljs-number">8</span>] * (flag[<span class="hljs-number">8</span>]) -<br>flag[<span class="hljs-number">2</span>] * <span class="hljs-number">134</span> +<br>flag[<span class="hljs-number">14</span>] * (flag[<span class="hljs-number">14</span>]) -<br>flag[<span class="hljs-number">13</span>] * <span class="hljs-number">170</span> +<br>flag[<span class="hljs-number">4</span>] * (flag[<span class="hljs-number">4</span>]) -<br>flag[<span class="hljs-number">10</span>] * <span class="hljs-number">142</span> +<br>flag[<span class="hljs-number">27</span>] * (flag[<span class="hljs-number">27</span>]) +<br>flag[<span class="hljs-number">15</span>] * (flag[<span class="hljs-number">15</span>]) -<br>flag[<span class="hljs-number">15</span>] * <span class="hljs-number">224</span> +<br>flag[<span class="hljs-number">16</span>] * (flag[<span class="hljs-number">16</span>]) -<br>flag[<span class="hljs-number">11</span>] * <span class="hljs-number">230</span> -<br>flag[<span class="hljs-number">1</span>] * <span class="hljs-number">178</span> +<br>flag[<span class="hljs-number">28</span>] * (flag[<span class="hljs-number">28</span>]) -<br>flag[<span class="hljs-number">5</span>] * <span class="hljs-number">246</span> -<br>flag[<span class="hljs-number">17</span>] * <span class="hljs-number">168</span> +<br>flag[<span class="hljs-number">30</span>] * (flag[<span class="hljs-number">30</span>]) -<br>flag[<span class="hljs-number">21</span>] * <span class="hljs-number">220</span> -<br>flag[<span class="hljs-number">22</span>] * <span class="hljs-number">212</span> -<br>flag[<span class="hljs-number">16</span>] * <span class="hljs-number">232</span> +<br>flag[<span class="hljs-number">25</span>] * (flag[<span class="hljs-number">25</span>]) -<br>flag[<span class="hljs-number">4</span>] * <span class="hljs-number">140</span> -<br>flag[<span class="hljs-number">31</span>] * <span class="hljs-number">250</span> -<br>flag[<span class="hljs-number">28</span>] * <span class="hljs-number">150</span> +<br>flag[<span class="hljs-number">11</span>] * (flag[<span class="hljs-number">11</span>]) +<br>flag[<span class="hljs-number">13</span>] * (flag[<span class="hljs-number">13</span>]) -<br>flag[<span class="hljs-number">14</span>] * <span class="hljs-number">234</span> +<br>flag[<span class="hljs-number">7</span>] * (flag[<span class="hljs-number">7</span>]) -<br>flag[<span class="hljs-number">8</span>] * <span class="hljs-number">174</span> +<br>flag[<span class="hljs-number">3</span>] * (flag[<span class="hljs-number">3</span>]) -<br>flag[<span class="hljs-number">25</span>] * <span class="hljs-number">242</span> +<br>flag[<span class="hljs-number">29</span>] * (flag[<span class="hljs-number">29</span>]) +<br>flag[<span class="hljs-number">5</span>] * (flag[<span class="hljs-number">5</span>]) -<br>flag[<span class="hljs-number">30</span>] * <span class="hljs-number">142</span> -<br>flag[<span class="hljs-number">26</span>] * <span class="hljs-number">170</span> -<br>flag[<span class="hljs-number">19</span>] * <span class="hljs-number">176</span> +<br>flag[<span class="hljs-number">0</span>] * (flag[<span class="hljs-number">0</span>]) -<br>flag[<span class="hljs-number">27</span>] * <span class="hljs-number">168</span> +<br>flag[<span class="hljs-number">20</span>] * (flag[<span class="hljs-number">20</span>]) -<br>flag[<span class="hljs-number">20</span>] * <span class="hljs-number">212</span> +<br>flag[<span class="hljs-number">21</span>] * (flag[<span class="hljs-number">21</span>]) +<br>flag[<span class="hljs-number">6</span>] * (flag[<span class="hljs-number">6</span>]) +<br>整理得到flag<br>flag[<span class="hljs-number">18</span>] * (flag[<span class="hljs-number">18</span>]) -<br>flag[<span class="hljs-number">18</span>] * <span class="hljs-number">178</span> +<br><span class="hljs-number">297412</span> == <span class="hljs-number">0</span><br>)<br>if solver.check() == sat:<br>model = solver.model()<br>print(model)<br>solution = [model.evaluate(flag[i] for i in range(<span class="hljs-number">32</span>))]<br>print(<span class="hljs-string">&quot;Solution found:&quot;</span>)<br>print(solution)<br>for i in range(<span class="hljs-number">32</span>):<br>print(chr(int(str(model[flag[i]]))), end=<span class="hljs-string">&quot;&quot;</span>)<br>else:<br>print(<span class="hljs-string">&quot;No solution found.&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>最后得到</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta"># flag[18] = 89,</span><br><span class="hljs-meta"># flag[6] = 113,</span><br><span class="hljs-meta"># flag[10] = 71,</span><br><span class="hljs-meta"># flag[17] = 84,</span><br><span class="hljs-meta"># flag[5] = 123,</span><br><span class="hljs-meta"># flag[21] = 110,</span><br><span class="hljs-meta"># flag[12] = 99,</span><br><span class="hljs-meta"># flag[20] = 106,</span><br><span class="hljs-meta"># flag[7] = 55,</span><br><span class="hljs-meta"># flag[24] = 111,</span><br><span class="hljs-meta"># flag[2] = 67,</span><br><span class="hljs-meta"># flag[26] = 85,</span><br><span class="hljs-meta"># flag[23] = 75,</span><br><span class="hljs-meta"># flag[1] = 89,</span><br><span class="hljs-meta"># flag[16] = 116,</span><br><span class="hljs-meta"># flag[25] = 121,</span><br><span class="hljs-meta"># flag[30] = 71,</span><br><span class="hljs-meta"># flag[14] = 117,</span><br><span class="hljs-meta"># flag[4] = 70,</span><br><span class="hljs-meta"># flag[11] = 115,</span><br><span class="hljs-meta"># flag[3] = 84,</span><br><span class="hljs-meta"># flag[28] = 75,</span><br><span class="hljs-meta"># flag[9] = 89,</span><br><span class="hljs-meta"># flag[15] = 112,</span><br><span class="hljs-meta"># flag[22] = 106,</span><br><span class="hljs-meta"># flag[8] = 87,</span><br><span class="hljs-meta"># flag[13] = 85,</span><br><span class="hljs-meta"># flag[29] = 116,</span><br><span class="hljs-meta"># flag[31] = 125,</span><br><span class="hljs-meta"># flag[0] = 88,</span><br><span class="hljs-meta"># flag[27] = 84,</span><br><span class="hljs-meta"># flag[19] = 88</span><br></code></pre></td></tr></table></figure>





<h2 id="easy-language"><a href="#easy-language" class="headerlink" title="easy language"></a>easy language</h2><p><a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1414525-1-1.html">https://www.52pojie.cn/thread-1414525-1-1.html</a>  <strong>IDA7.5支持中文函数命名的办法</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405071505877.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240507150507591"></p>
<p>这个地方能看到WelcometoXYCTF字符串（string窗口）这个图是IDA7.6开的</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405071530293.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240507153057140"></p>
<p>图中横线貌似是因为函数名称被过度优化掉了</p>
<p>然后我们试试IDA7.5（还是有点小不习惯）</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405080134910.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240508013453769"></p>
<p>直接导入插件后好像查看函数窗口没有很明显的效果（不知道为什么）</p>
<p>从字符串交叉引用出主要逻辑处</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405080136889.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240508013632840"></p>
<p><code>lpMem</code>通过调用<code>编辑框::编辑框1_读属性_内容</code>方法获得一个字符，后续分别进行AES-ECB加密以及base64编码</p>
<p><img src="https://cdn.jsdelivr.net/gh/pzlzx/tuchuang@main/main/202405080142169.png" srcset="/\img\A008779F61D12BE23A64C76080892F5C.jpg" lazyload alt="image-20240508014231091"></p>
<p>后面逻辑其实可以直接通过看字符串窗口猜，试几次就出来了</p>
<p>也可以参考这个<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42557115/article/details/138267583">https://blog.csdn.net/qq_42557115/article/details/138267583</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/wp/" class="print-no-link">#wp</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>XYCTF RE WP1</div>
      <div>http://example.com/2024/05/08/XYCTF RE WP/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年5月8日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/04/13/AES%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/" title="AES 加密算法（理解篇）">
                        <span class="hidden-mobile">AES 加密算法（理解篇）</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
