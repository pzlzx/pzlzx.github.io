<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title></title>
    <link href="/2023/12/18/%E6%9E%81%E5%AE%A2wp/"/>
    <url>/2023/12/18/%E6%9E%81%E5%AE%A2wp/</url>
    
    <content type="html"><![CDATA[<h4 id="点击就送的逆向题"><a href="#点击就送的逆向题" class="headerlink" title="点击就送的逆向题"></a>点击就送的逆向题</h4><p>发现文件后缀名是.s</p><p>gcc命令其实依次执行了四步操作：</p><p>1.预处理(Preprocessing)</p><p>2.编译(Compilation),</p><p>3.汇编(Assemble),</p><p>4.链接(Linking)。</p><p><a href="https://zhuanlan.zhihu.com/p/111500914">GCC编译过程（预处理-&gt;编译-&gt;汇编-&gt;链接） - 知乎 (zhihu.com)</a></p><p>通过上述内容发现还需要先将汇编代码.s变成机器码.o，生成目标文件</p><p>在虚拟机里面进行</p><p><a href="https://www.imagehub.cc/image/1xzw0z"><img src="https://s1.imagehub.cc/images/2023/11/27/a2d5158a58c6d18755b59e46bbe6103a.png" alt="a2d5158a58c6d18755b59e46bbe6103a.png"></a></p><p>然后把得到的目标文件拖64IDA里面，观察逻辑发现处理后得到的s1和s2相等，再推回去即可</p><p><a href="https://www.imagehub.cc/image/1xze8j"><img src="https://s1.imagehub.cc/images/2023/11/27/90d0a9715d3dcdee04498c8f5d208a9c.png" alt="90d0a9715d3dcdee04498c8f5d208a9c.png"></a></p><p><a href="https://www.imagehub.cc/image/1xz6PR"><img src="https://s1.imagehub.cc/images/2023/11/27/9b657dac96012ce3b07e77690e1c8cb3.png" alt="9b657dac96012ce3b07e77690e1c8cb3.png"></a></p><h4 id="幸运数字"><a href="#幸运数字" class="headerlink" title="幸运数字"></a>幸运数字</h4><p>拖进DIE发现是PE64，搞64位IDA里面去</p><p><a href="https://www.imagehub.cc/image/1xmtHv"><img src="https://s1.imagehub.cc/images/2023/11/27/a74a56791c4338fff2860ffa5d5752db.md.png" alt="a74a56791c4338fff2860ffa5d5752db.md.png"></a></p><p><a href="https://www.imagehub.cc/image/1xmxot"><img src="https://s1.imagehub.cc/images/2023/11/27/8bc3d63e470aeb29d7976619d0623346.png" alt="8bc3d63e470aeb29d7976619d0623346.png"></a></p><p>由上面二图可知，对&amp;Format,&amp;Buffer,&amp;byte_40401C点进去a一下得下图，cmp_data存的是ascii，所以注意46行存储数据的处理，转换成对应的ascii，这个地方刚好只存了5个字符到数组中，得到对应的数据为111, 57, 54, 42, 35</p><p><a href="https://www.imagehub.cc/image/1xmEbS"><img src="https://s1.imagehub.cc/images/2023/11/27/76bf846c9319db536c7d48e43060a9aa.png" alt="76bf846c9319db536c7d48e43060a9aa.png"></a></p><p><a href="https://www.imagehub.cc/image/1xmGEL"><img src="https://s1.imagehub.cc/images/2023/11/27/cc3329e3d5dcaaac28b90f185d59a2ab.md.png" alt="cc3329e3d5dcaaac28b90f185d59a2ab.md.png"  /></a></p><p>对v5进行处理，发现是个递归，k在0-999，则取k&#x3D;0，此时返回值为result(-1)+0;取不到result(-1)，因为k为unsigned，</p><p>所以k&#x3D;0时返回值为0；</p><p>取k&#x3D;1，返回值为1</p><p>取k&#x3D;2，返回值为1+2</p><p>…………</p><p>故v5 &#x3D; (1+k)*k&#x2F;2</p><p><a href="https://www.imagehub.cc/image/1xmPvB"><img src="https://s1.imagehub.cc/images/2023/11/27/587e59f04c3844ae08f84141af5a07e2.png" alt="587e59f04c3844ae08f84141af5a07e2.png"></a></p><p>取余记得用 int 取整</p><p>防止数据超出ascii码表值，所以&amp;0xFF,取低八位或者直接%256</p><p><a href="https://www.imagehub.cc/image/1xmRSq"><img src="https://s1.imagehub.cc/images/2023/11/27/1b6cbeb5cb83824acd5b16c483c5bfdc.md.png" alt="1b6cbeb5cb83824acd5b16c483c5bfdc.md.png"></a></p><p>最后记得对输出的字符串进行筛选……</p><p><img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20231218213448153.png" alt="image-20231218213448153"></p><p><img src="C:\Users\asus\AppData\Roaming\Typora\typora-user-images\image-20231218213513118.png" alt="image-20231218213513118"></p><h4 id="shiftjmp"><a href="#shiftjmp" class="headerlink" title="shiftjmp"></a>shiftjmp</h4><p><a href="https://imgse.com/i/piBJS1O"><img src="https://z1.ax1x.com/2023/11/27/piBJS1O.md.png" alt="piBJS1O.md.png"></a></p><p>进到main函数里面以后发现无法生成反汇编代码</p><p>汇编跳转指令有问题</p><p>因为jz前为rax和rax的异或 值为0</p><p>所以执行jz后的指令 跳转到 loc_117A+1，为117B</p><p>发现中间地址被折叠了</p><p>所以对着117A地址D一下，得到下图</p><p><a href="https://imgse.com/i/piBJPnH"><img src="https://z1.ax1x.com/2023/11/27/piBJPnH.md.png" alt="piBJPnH.md.png"></a></p><p><a href="https://imgse.com/i/piBJV4P"><img src="https://z1.ax1x.com/2023/11/27/piBJV4P.png" alt="piBJV4P.png"></a></p><p>指令地址不连续，把0E9h在下方按F2改成0x90，空指令对应机器码，nop，地址连续，然后选中p一下</p><p>就可以生成反汇编代码了</p><p><a href="https://imgse.com/i/piBJe9f"><img src="https://z1.ax1x.com/2023/11/27/piBJe9f.md.jpg" alt="piBJe9f.md.jpg"></a></p><p>逻辑可知得到0，异或回去</p><p>注意把rodata字符串转换成ASCII形式就可以了</p><p><a href="https://imgse.com/i/piBJMuQ"><img src="https://z1.ax1x.com/2023/11/27/piBJMuQ.png" alt="piBJMuQ.png"></a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2023/12/18/hello-world/"/>
    <url>/2023/12/18/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
